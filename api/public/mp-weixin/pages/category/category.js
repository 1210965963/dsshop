(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/category"],{"16d1":function(t,e,i){"use strict";var n=i("55b4"),o=i.n(n);o.a},"1e92":function(t,e,i){"use strict";i.r(e);var n=i("2cd5"),o=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=o.a},"2cd5":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(i("2eee")),r=n(i("c973")),a=n(i("1580")),s=n(i("96fe")),l={components:{uniLoadMore:function(){i.e("components/uni-load-more/uni-load-more").then(function(){return resolve(i("25ed"))}.bind(null,i)).catch(i.oe)}},data:function(){return{navHeight:getApp().globalData.navHeight?getApp().globalData.navHeight:10,sizeCalcState:!1,tabScrollTop:0,currentId:49,flist:[],slist:[],tlist:[],tap:0,goodsList:[],page:1,loadingType:"more",filterIndex:"",is_notice:!1}},onLoad:function(){this.loadData(),this.notice()},onShow:function(){t.setNavigationBarTitle({title:this.$t("tab_bar.1")})},methods:{loadData:function(){var t=this;return(0,r.default)(o.default.mark((function e(){var i;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,e.next=3,a.default.goodCategory({},(function(t){t.forEach((function(t){t.pid?t.resources?i.tlist.push(t):i.slist.push(t):i.flist.push(t)})),0===i.tlist.length&&i.flist.length>0&&(i.currentId=i.flist[0].id,i.getGood()),i.$nextTick((function(){!i.sizeCalcState&&i.tlist.length>0&&i.calcSize()}))}));case 3:case"end":return e.stop()}}),e)})))()},getGood:function(){var t=arguments,e=this;return(0,r.default)(o.default.mark((function i(){var n,r;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:"add",t.length>1?t[1]:void 0,"refresh"===n&&(e.page=1,e.goodsList=[]),"add"!==n){i.next=9;break}if("nomore"!==e.loadingType){i.next=6;break}return i.abrupt("return");case 6:e.loadingType="loading",i.next=10;break;case 9:e.loadingType="more";case 10:return[],r=e,i.next=14,a.default.getList({limit:10,category_id:e.currentId,page:e.page,sort:e.filterIndex},(function(t){r.goodsList=r.goodsList.concat(t.data),t.last_page>r.page?(r.page++,r.loadingType="more"):r.loadingType="nomore"}));case 14:case"end":return i.stop()}}),i)})))()},tabClick:function(e){e?"sales"===e?this.filterIndex="-sales":"+order_price"!==this.filterIndex?this.filterIndex="+order_price":this.filterIndex="-order_price":this.filterIndex="",t.pageScrollTo({duration:300,scrollTop:0}),this.getGood("refresh",1),t.showLoading({title:this.$t("load_more.content_refresh")})},tabtap:function(t,e){if(this.tlist.length)if(this.sizeCalcState||this.calcSize(),this.tap=1,this.currentId=t.id,this.slist.length>0){var i=this.slist.findIndex((function(e){return e.pid===t.id}));this.tabScrollTop===this.slist[i].top?this.tabScrollTop=this.slist[i].top+1:this.tabScrollTop=this.slist[i].top}else{var n=this.flist.findIndex((function(e){return e.id===t.id}));this.tabScrollTop===this.flist[n].top?this.tabScrollTop=this.flist[n].top+1:this.tabScrollTop=this.flist[n].top}else this.currentId=t.id,this.getGood("refresh",1)},asideScroll:function(t){!this.sizeCalcState&&this.tlist.length>0&&this.calcSize();var e=t.detail.scrollTop,i=null;this.slist.length>0?(i=this.slist.filter((function(t){return t.top<=e})).reverse(),i.length>0&&!this.tap&&(this.currentId=i[0].pid)):(i=this.flist.filter((function(t){return t.top<=e})).reverse(),i.length>0&&!this.tap&&(this.currentId=i[0].id)),this.tap=0},calcSize:function(){var e=this,i=0;this.slist.length>0?this.slist.forEach((function(e){var n=t.createSelectorQuery().select("#main-"+e.id);n.fields({size:!0},(function(t){e.top=i,i+=t.height,e.bottom=i})).exec()})):this.flist.forEach((function(n){var o=t.createSelectorQuery().select("#main-"+n.id);o.fields({size:!0},(function(t){0===i&&(e.currentId=n.id),n.top=i,i+=t.height,n.bottom=i})).exec()})),this.sizeCalcState=!0},navToList:function(e,i){t.navigateTo({url:"/pages/product/list?fid=".concat(this.currentId,"&sid=").concat(e,"&tid=").concat(i)})},notice:function(){var t=this;s.default.unread({},(function(e){t.is_notice=!!e}))},lower:function(t){this.getGood()},goHome:function(){t.switchTab({url:"/pages/index/index"})},navTo:function(e){t.navigateTo({url:e})}}};e.default=l}).call(this,i("543d")["default"])},"55b4":function(t,e,i){},"7fd8":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var n={uniLoadMore:function(){return i.e("components/uni-load-more/uni-load-more").then(i.bind(null,"25ed"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.$t("category.search")),n=t.tlist.length,o=n>0?t.slist.length:null,r=n>0&&o>0?t.__map(t.slist,(function(e,i){var n=t.__get_orig(e),o=t.__map(t.tlist,(function(i,n){var o=t.__get_orig(i),r=i.pid===e.id?t._f("smallImage")(i.resources.img,80):null;return{$orig:o,f0:r}}));return{$orig:n,l0:o}})):null,a=n>0&&!(o>0)?t.__map(t.flist,(function(e,i){var n=t.__get_orig(e),o=t.__map(t.tlist,(function(i,n){var o=t.__get_orig(i),r=i.pid===e.id?t._f("smallImage")(i.resources.img,80):null;return{$orig:o,f1:r}}));return{$orig:n,l2:o}})):null,s=n>0?null:t.__map(t.goodsList,(function(e,i){var n=t.__get_orig(e),o=t._f("smallImage")(e.resources.img),r=t.$t("common.unit"),a=t._f("1000")(e.order_price);return{$orig:n,f2:o,m1:r,f3:a}}));t.$mp.data=Object.assign({},{$root:{m0:i,g0:n,g1:o,l1:r,l3:a,l4:s}})},r=[]},ad91:function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("18f9");n(i("66fd"));var o=n(i("cc2e"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},cc2e:function(t,e,i){"use strict";i.r(e);var n=i("7fd8"),o=i("1e92");for(var r in o)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(r);i("16d1");var a=i("f0c5"),s=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=s.exports}},[["ad91","common/runtime","common/vendor"]]]);