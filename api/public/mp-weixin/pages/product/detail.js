(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail"],{"36ed":function(e,t,i){"use strict";i.r(t);var n=i("ef55"),r=i("6056");for(var o in r)"default"!==o&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("8dcd");var s,a=i("f0c5"),u=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=u.exports},6056:function(e,t,i){"use strict";i.r(t);var n=i("f65b"),r=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=r.a},"75b4":function(e,t,i){"use strict";(function(e){i("18f9");n(i("66fd"));var t=n(i("36ed"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=i,e(t.default)}).call(this,i("543d")["createPage"])},"8dcd":function(e,t,i){"use strict";var n=i("9bec"),r=i.n(n);r.a},"9bec":function(e,t,i){},ef55:function(e,t,i){"use strict";var n;i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,!e.isSeckill&&e.isGroupPurchase&&e.foremanTotal>0?e.__map(e.foremanList,(function(t,n){var r=e.__get_orig(t),o=n<2?e.__map(t.user,(function(t,n){var r=e.__get_orig(t),o=t.portrait?null:i("f569");return{$orig:r,m0:o}})):null;return{$orig:r,l0:o}})):null),r=!e.isSeckill&&e.isGroupPurchase&&e.foremanTotal>0?e.__map(e.foremanList,(function(t,n){var r=e.__get_orig(t),o=n<2?e.__map(t.user,(function(t,n){var r=e.__get_orig(t),o=t.portrait?null:i("f569");return{$orig:r,m1:o}})):null;return{$orig:r,l2:o}})):null,o=e.verify.comment?e.__map(e.commentList,(function(t,i){var n=e.__get_orig(t),r=t.comment.created_at.split(" ");return{$orig:n,g0:r}})):null,s=e.foremanShare.id&&!e.foremanShare.portrait?i("f569"):null;e.$mp.data=Object.assign({},{$root:{l1:n,l3:r,l4:o,m2:s}})},o=[]},f65b:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=m(i("a34a")),r=m(i("1580")),o=(i("2f14"),m(i("2d6f"))),s=m(i("bb79")),a=i("b0ed"),u=i("ad8f"),c=i("2146"),f=i("a1dc"),l=i("57f5"),d=m(i("e46e")),p=i("26cb");function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function h(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t,i,n,r,o,s){try{var a=e[o](s),u=a.value}catch(c){return void i(c)}a.done?t(u):Promise.resolve(u).then(n,r)}function y(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var o=e.apply(t,i);function s(e){v(o,n,r,s,a,"next",e)}function a(e){v(o,n,r,s,a,"throw",e)}s(void 0)}))}}var L=function(){Promise.all([i.e("common/vendor"),i.e("components/gaoyia-parse/parse")]).then(function(){return resolve(i("e6b2"))}.bind(null,i)).catch(i.oe)},b=function(){i.e("components/share").then(function(){return resolve(i("d3e3"))}.bind(null,i)).catch(i.oe)},k=function(){Promise.all([i.e("common/vendor"),i.e("components/sku/index")]).then(function(){return resolve(i("3e46"))}.bind(null,i)).catch(i.oe)},w=function(){i.e("pages/coupon/components/index").then(function(){return resolve(i("8d6e"))}.bind(null,i)).catch(i.oe)},O=function(){i.e("pages/seckill/components/CountDownTime").then(function(){return resolve(i("4fa4"))}.bind(null,i)).catch(i.oe)},P={components:{share:b,sku:k,uParse:L,coupon:w,CountDownTime:O},data:function(){return{cartGood:{},id:"",specClass:"none",specificationDefaultDisplay:"",getList:{is_delete:0,is_show:1},inventoryFlag:!0,shoppingAttributes:[],favorite:!1,shareList:[],poster:"",resources_many:[],video:"",index:0,buy:!1,commentList:[],commentTotal:0,couponList:[],couponShow:!1,verify:{coupon:!1,comment:!1,seckill:!1,groupPurchase:!1},isSeckill:!1,isGroupPurchase:!1,foremanList:[],foremanTotal:0,modalName:"",gfid:0,foremanShare:{}}},onLoad:function(e){var t=this;return y(n.default.mark((function i(){var r;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=e.id,t.id=r,e.gfid&&(t.gfid=e.gfid),t.getVerifyPlugin();case 4:case"end":return i.stop()}}),i)})))()},computed:h({},(0,p.mapState)(["hasLogin"])),onReady:function(t){this.videoContext=e.createVideoContext("myVideo")},methods:{getVerifyPlugin:function(){var e=this;(0,c.verifyPlugin)(["coupon","comment","seckill","groupPurchase"],(function(t){e.verify=t,e.id&&(e.loadData(e.id),e.verify.comment&&e.goodEvaluate()),e.hasLogin&&e.verify.coupon&&e.getCoupon()}))},loadData:function(e){var t=this;return y(n.default.mark((function i(){var o;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=t,i.next=3,r.default.detail(e,{},function(){var t=y(n.default.mark((function t(i){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i.resources_many.length>0&&i.resources_many.forEach((function(e,t){-1!==e.depict.indexOf("_video")?(e.type="video",o.resources_many.unshift(e)):-1!==e.depict.indexOf("_poster")?o.poster=e.img:(e.type="img",o.resources_many.push(e))})),o.getList=i,!o.verify.seckill){t.next=5;break}return t.next=5,(0,f.detail)(e,{},(function(t){if(t){o.isSeckill=!0,o.getList.name=t.name,o.getList.abstract=t.abstract,o.getList.details=t.details,o.getList.state=t.state,o.getList.resources_many=t.resources_many,o.getList.seckill_time=t.time,o.getList.seckill=!0,o.getList.seckill_id=t.id,o.getList.price_show=t.price_show,o.getList.market_price_show=t.market_price_show,t.state?o.getList.seckillTime=((0,d.default)(t.end_time).valueOf()-(0,d.default)().valueOf())/1e3:o.getList.seckillTime=((0,d.default)(t.time).valueOf()-(0,d.default)().valueOf())/1e3;var n=JSON.parse(JSON.stringify(o.getList.good_sku)),r={};o.getList.good_sku=[],n.forEach((function(e){r=t.seckill_sku.find((function(t){return t.good_sku_id===e.id})),r&&(e.market_price=r.price/100,e.price=r.seckill_price/100,e.resources=r.resources,e.seckill_sku_id=r.id,e.inventory=r.residue_limit,1===t.is_purchase_number&&(o.getList.purchase_number=t.purchase_number),o.getList.good_sku.push(e))})),o.resources_many=[],i.resources_many.length>0&&i.resources_many.forEach((function(e,t){-1!==e.depict.indexOf("_video")?(e.type="video",o.resources_many.unshift(e)):-1!==e.depict.indexOf("_poster")?o.poster=e.img:(e.type="img",o.resources_many.push(e))})),o.$refs.sku._setData(o.getList.good_sku)}else o.verify.groupPurchase&&(0,l.detail)(e,{},(function(e){if(e){o.isGroupPurchase=!0,o.getList.name=e.name,o.getList.abstract=e.abstract,o.getList.details=e.details,o.getList.state=e.state,o.getList.resources_many=e.resources_many,o.getList.group_purchase_time=e.time,o.getList.group_purchase=!0,o.getList.group_purchase_id=e.id,o.getList.group_purchase_number=e.number,o.getList.price_show=e.price_show,o.getList.market_price_show=e.market_price_show,e.state?o.getList.groupPurchaseTime=((0,d.default)(e.end_time).valueOf()-(0,d.default)().valueOf())/1e3:o.getList.groupPurchaseTime=((0,d.default)(e.time).valueOf()-(0,d.default)().valueOf())/1e3;var t=JSON.parse(JSON.stringify(o.getList.good_sku)),n={};o.getList.good_sku=[],t.forEach((function(t){n=e.group_purchase_sku.find((function(e){return e.good_sku_id===t.id})),n&&(t.market_price=n.price/100,t.price=n.group_purchase_price/100,t.resources=n.resources,t.group_purchase_sku_id=n.id,t.inventory=n.residue_limit,o.getList.good_sku.push(t))})),o.resources_many=[],i.resources_many.length>0&&i.resources_many.forEach((function(e,t){-1!==e.depict.indexOf("_video")?(e.type="video",o.resources_many.unshift(e)):-1!==e.depict.indexOf("_poster")?o.poster=e.img:(e.type="img",o.resources_many.push(e))})),o.$refs.sku._setData(o.getList.good_sku),(0,l.foreman)(e.id,(function(e){o.foremanList=e.data,o.gfid&&(o.modalName="foremanShare",o.foremanShare=o.foremanList.find((function(e){return e.id==o.gfid})),o.foremanShare=o.foremanShare?o.foremanShare:{}),o.foremanTotal=e.total}))}}))}));case 5:o.getList.good_sku.length<=0&&(o.inventoryFlag=!1),o.hasLogin&&o.browse();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:if(!o.hasLogin){i.next=6;break}return i.next=6,s.default.detail(e,(function(e){o.favorite=1===e}));case 6:case"end":return i.stop()}}),i)})))()},imgCtu:function(e){this.index=e.target.current},showVideo:function(){var e=this.resources_many[this.index];"video"===e.type&&(this.video=e.img)},closeVideo:function(){this.video=""},browse:function(){var e=this.getList;o.default.create(e,(function(e){}))},imgList:function(){var t=[];this.resources_many.forEach((function(e){"video"!==e.type&&t.push(e.img)})),e.previewImage({urls:t,longPressActions:{success:function(e){},fail:function(e){}}})},toggleSpec:function(e,t){var i=this;if(!this.hasLogin&&!0===e)return this.$api.msg("请先登录"),!1;t&&(this.getList.gropuPurchaseId=t,this.modalName=null),"boolean"===typeof e&&(this.buy=e),"show"===this.specClass?(this.specClass="hide",setTimeout((function(){i.specClass="none"}),250)):"none"===this.specClass&&(this.specClass="show")},share:function(){this.$refs.share.toggleMask()},toFavorite:function(){if(this.hasLogin){var e=this.getList;this.favorite?s.default.destroy(e.id,(function(e){})):s.default.create(e,(function(e){}))}this.favorite=!this.favorite},purchasePattern:function(e){this.specificationDefaultDisplay=e},stopPrevent:function(){},goodEvaluate:function(){var e=this;(0,a.good)({limit:2,page:1,good_id:this.id,sort:"-created_at"},(function(t){t.total>0&&(e.commentList=t.data,e.commentTotal=t.total)}))},changeShow:function(e){if(!this.hasLogin)return this.$api.msg("请先登录"),!1;this.couponShow=e},getCoupon:function(){var e=this;(0,u.getList)({},(function(t){e.couponList=[],t.data.forEach((function(t){var i={id:t.id,money:t.cost/100,title:t.explain,type:t.type,time:t.start_time.split(" ")[0].replace(/-/g,".")+"-"+t.end_time.split(" ")[0].replace(/-/g,".")};t.limit_get&&t.user_coupon_count>=t.limit_get?i.state="2":i.state="1",e.couponList.push(i)}))}))},endTime:function(){this.loadData()},setModal:function(e){this.modalName=e},hideModal:function(e){this.modalName=null}}};t.default=P}).call(this,i("543d")["default"])}},[["75b4","common/runtime","common/vendor"]]]);