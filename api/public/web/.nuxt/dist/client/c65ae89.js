(window.webpackJsonp=window.webpackJsonp||[]).push([[40,39],{504:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return f}));var o=n(8),c=n(19),l=n.n(c);function r(t){return Object(o.a)({url:"coupon",method:"GET",params:t})}function d(t){return Object(o.a)({url:"coupon/user",method:"GET",params:t})}function f(data){return data=l.a.parse(data),Object(o.a)({url:"coupon",method:"POST",data:data})}},527:function(t,e,n){var content=n(551);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("1a6f2ee4",content,!0,{sourceMap:!1})},540:function(t,e,n){"use strict";n.r(e);var o=n(17),c=n(7),l=(n(36),n(291),n(13),n(24),n(30),n(18),n(504));e.default={name:"CouponUse",props:{money:{type:Number,default:0}},data:function(){return{tableLoading:!1,checkboxAll:!1,loading:!0,buttonLoading:!1,list:[],total:0,couponMoney:0,couponIndex:null,visible:!1,listQuery:{limit:100,money:0,index:1,page:1,sort:"-created_at"}}},watch:{money:function(t){this.listQuery.money=t,this.getList()}},methods:{getList:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,Promise.all([Object(l.c)(t.listQuery)]).then((function(e){var data=Object(o.a)(e,1)[0];data.data.forEach((function(e,n){switch(e.coupon.type){case 1:case 2:e.cost=e.coupon.cost/100,e.cost>t.couponMoney&&(t.couponMoney=e.cost,t.couponIndex=n);break;case 3:e.cost=t.listQuery.money*e.coupon.cost/1e4,e.cost>t.couponMoney&&(t.couponMoney=e.cost,t.couponIndex=n)}e.coupon.sill?e.sill="满"+e.coupon.sill/100+"可用":e.sill="无门槛"})),t.list=data.data,t.total=data.total,t.loading=!1,t.$emit("select",t.list[t.couponIndex])})).catch((function(e){t.loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},select:function(t,e){this.couponIndex=e,this.visible=!1,this.$emit("select",t)}}}},550:function(t,e,n){"use strict";n(527)},551:function(t,e,n){var o=n(11)(!1);o.push([t.i,".coupon[data-v-27d1b77a]{display:flex;justify-content:flex-end}.coupon .tag[data-v-27d1b77a]{line-height:30px;cursor:pointer;border:1px dashed #fa524c;color:#fa524c;text-align:center;padding:0 10px}.ul .li[data-v-27d1b77a]{padding:10px;display:flex;align-items:flex-start}.ul .li .money[data-v-27d1b77a]{color:#fa524c;width:70px;text-align:center;border:1px dashed #fa524c;line-height:25px;padding:0 10px;margin:5px 10px 5px 0}.ul .li .explain[data-v-27d1b77a]{width:220px;padding-right:10px}.ul .li .explain .name[data-v-27d1b77a]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ul .li .button[data-v-27d1b77a]{margin-top:8px}",""]),t.exports=o},639:function(t,e,n){"use strict";n.r(e);var o=n(540).default,c=(n(550),n(6)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"coupon"},[n("el-popover",{attrs:{placement:"bottom",width:"400",trigger:"click"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("div",{staticClass:"ul"},t._l(t.list,(function(e,o){return n("div",{key:o,staticClass:"li"},[n("div",{staticClass:"money"},[n("span",[t._v("￥")]),t._v(t._s(e.cost))]),t._v(" "),n("div",{staticClass:"explain"},[n("div",{staticClass:"name"},[t._v(t._s(e.coupon.explain))]),t._v(" "),e.coupon.end_time?n("div",{staticClass:"time"},[t._v("有效期至"+t._s(t._f("moment")(e.coupon.end_time,"YYYY.MM.DD")))]):n("div",{staticClass:"time"},[t._v("不限")])]),t._v(" "),n("el-button",{staticClass:"button",attrs:{type:"primary",size:"mini",loading:t.buttonLoading,disabled:t.couponIndex===o},on:{click:function(n){return t.select(e,o)}}},[t._v(t._s(t.couponIndex===o?"已选":"选择"))])],1)})),0),t._v(" "),n("div",{staticClass:"tag",attrs:{slot:"reference"},slot:"reference"},[t.list[t.couponIndex]?[t._v("\n            "+t._s(t.list[t.couponIndex].coupon.name)+"\n          ")]:[t._v("\n            选择优惠券\n          ")],t._v(" "),n("i",{staticClass:"el-icon-caret-bottom"})],2)])],1)])}),[],!1,null,"27d1b77a",null);e.default=component.exports}}]);