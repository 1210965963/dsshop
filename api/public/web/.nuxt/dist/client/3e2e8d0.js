(window.webpackJsonp=window.webpackJsonp||[]).push([[10,9],{510:function(e,t,r){var content=r(660);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(12).default)("17f2989c",content,!0,{sourceMap:!1})},512:function(e,t,r){"use strict";r.d(t,"f",(function(){return d})),r.d(t,"a",(function(){return c})),r.d(t,"d",(function(){return m})),r.d(t,"c",(function(){return f})),r.d(t,"e",(function(){return h})),r.d(t,"b",(function(){return v}));var n=r(8),o=r(19),l=r.n(o);function d(e){return Object(n.a)({url:"shipping",method:"GET",params:e})}function c(data){return data=l.a.parse(data),Object(n.a)({url:"shipping",method:"POST",data:data})}function m(data){return data=l.a.parse(data),Object(n.a)({url:"shipping/"+data.id,method:"POST",data:data})}function f(e){return Object(n.a)({url:"shipping/destroy/"+e,method:"POST"})}function h(e,data){return data=l.a.parse(data),Object(n.a)({url:"shipping/freight/"+e,method:"POST",data:data})}function v(data){return data=l.a.parse(data),Object(n.a)({url:"shipping/default/set",method:"POST",data:data})}},657:function(e,t,r){"use strict";r.r(t);var n=r(7),o=(r(36),r(18),r(512));t.default={name:"AddressList",props:{select:{type:Boolean,default:!1}},data:function(){return{src:"https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=BHBBZ-25TCP-YRODO-VQXIO-RZKP6-AEBEC&referer=myapp",restaurants:[],buttonLoading:!1,loading:!1,dialogTitle:"添加收货地址",centerDialogVisible:!1,list:[],ruleForm:{location:"",address:"",name:"",house:"",cellphone:"",latitude:"",longitude:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],cellphone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(e,t,r){if(""===t)r(new Error("请输入手机号"));else{/^(((13[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(t)||r(new Error("手机号格式有误")),r()}},trigger:"blur"}],house:[{required:!0,message:"请输入门牌号",trigger:"blur"}]}}},watch:{},mounted:function(){this.getList(),window.addEventListener("message",this.handleSelect)},methods:{getList:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(o.f)({sort:"-defaults"}).then((function(t){e.loading=!1,e.list=t.data,e.list.forEach((function(t){t.defaults?(t.on=!0,e.$emit("selectedAddress",t)):t.on=!1}))})).catch((function(){e.loading=!1}));case 3:case"end":return t.stop()}}),t)})))()},switchAddress:function(e){this.select&&(this.list.forEach((function(e){e.on=!1})),e.on=!0,this.$emit("selectedAddress",e),this.$forceUpdate())},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.buttonLoading=!0,e.ruleForm.id?Object(o.d)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.$refs.ruleForm.resetFields(),e.getList(),e.$message({message:"修改成功",type:"success"})})).catch((function(){e.buttonLoading=!1})):(e.ruleForm.longitude||e.$message.error("请选择地址"),Object(o.a)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.$refs.ruleForm.resetFields(),e.getList(),e.$message({message:"添加成功",type:"success"})})).catch((function(){e.buttonLoading=!1}))))}))},defaultAddress:function(e){var t=this;this.$confirm("是否设为默认？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){t.buttonLoading=!0,Object(o.b)(e).then((function(e){t.buttonLoading=!1,t.getList(),t.$message({message:"设置成功",type:"success"})})).catch((function(){t.buttonLoading=!1}))})).catch((function(){}))},deleteAddress:function(e){var t=this;e.defaults?this.$message({message:"默认地址无法删除",type:"error"}):this.$confirm("确定要删除该地址吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){t.buttonLoading=!0,Object(o.c)(e.id).then((function(e){t.buttonLoading=!1,t.getList(),t.$message({message:"删除成功",type:"success"})})).catch((function(){t.buttonLoading=!1}))})).catch((function(){}))},updateAddress:function(e){e.id?(this.ruleForm=e,this.dialogTitle="修改收货地址"):(this.ruleForm={location:"",address:"",name:"",house:"",cellphone:"",latitude:"",longitude:""},this.dialogTitle="添加收货地址"),this.centerDialogVisible=!0},handleSelect:function(e){var t=e.data;t&&"locationPicker"===t.module&&(this.ruleForm.location=t.poiname,this.ruleForm.address=t.poiaddress,this.ruleForm.longitude=t.latlng.lng,this.ruleForm.latitude=t.latlng.lat)}}}},658:function(e,t,r){"use strict";r.r(t);var n=r(657).default,o=(r(659),r(6)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"address-list"},[e._l(e.list,(function(t,n){return r("div",{key:n,staticClass:"address-item"},[r("div",{staticClass:"item-on",class:{on:t.on&&e.select},on:{click:function(r){return e.switchAddress(t)}}},[r("div",{staticClass:"address-info"},[r("div",{staticClass:"name"},[e._v("\n              "+e._s(t.name)+"\n              "),t.defaults?r("span",[e._v("默认")]):e._e()]),e._v(" "),r("div",{staticClass:"cellphone"},[e._v(e._s(t.cellphone))]),e._v(" "),r("div",{staticClass:"address-con"},[e._v(e._s(t.location?t.location+"(":"")+e._s(t.address)+" "+e._s(t.house?")"+t.house:""))]),e._v(" "),r("div",{staticClass:"address-action"},[e.select?e._e():r("el-link",{attrs:{type:"danger",underline:!1},on:{click:function(r){return e.defaultAddress(t)}}},[e._v("设为默认")]),e._v(" "),r("el-link",{attrs:{type:"danger",underline:!1},on:{click:function(r){return e.updateAddress(t)}}},[e._v("修改")]),e._v(" "),e.select?e._e():r("el-link",{attrs:{type:"danger",underline:!1},on:{click:function(r){return e.deleteAddress(t)}}},[e._v("删除")])],1)])])])})),e._v(" "),r("div",{staticClass:"address-item",on:{click:e.updateAddress}},[e._m(0)])],2),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.centerDialogVisible,"close-on-click-modal":!1,width:"600px;height:500px;overflow-y: auto;"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"联系人",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"20",placeholder:"请输入姓名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号",prop:"cellphone"}},[r("el-input",{attrs:{clearable:"",maxlength:"11",placeholder:"请输入手机号"},model:{value:e.ruleForm.cellphone,callback:function(t){e.$set(e.ruleForm,"cellphone",t)},expression:"ruleForm.cellphone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"地址",prop:"location"}},[e.ruleForm.longitude?r("div",[e._v(e._s(e.ruleForm.location)+"("+e._s(e.ruleForm.address)+")")]):r("div",[e._v("请在地图中选择地址")]),e._v(" "),e.ruleForm.longitude?r("iframe",{staticClass:"iframe",attrs:{height:"500",frameborder:"0",src:e.src+"&coord="+e.ruleForm.latitude+","+e.ruleForm.longitude}}):r("iframe",{staticClass:"iframe",attrs:{height:"500",frameborder:"0",src:e.src}})]),e._v(" "),r("el-form-item",{attrs:{label:"门牌号",prop:"house"}},[r("el-input",{attrs:{clearable:"",maxlength:"80",placeholder:"请输入门牌号"},model:{value:e.ruleForm.house,callback:function(t){e.$set(e.ruleForm,"house",t)},expression:"ruleForm.house"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{loading:e.buttonLoading},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{loading:e.buttonLoading,type:"danger"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1)],1)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"item"},[r("div",{staticClass:"add-desc"},[r("div",[r("i",{staticClass:"el-icon-circle-plus"})]),e._v(" "),r("div",[e._v("添加新地址")])])])}],!1,null,"5c109676",null);t.default=component.exports},659:function(e,t,r){"use strict";r(510)},660:function(e,t,r){var n=r(11)(!1);n.push([e.i,".address-list[data-v-5c109676]{display:flex;flex-wrap:wrap;align-content:center}.address-list .address-item[data-v-5c109676]{width:25%;padding-right:10px;padding-bottom:10px}.address-list .address-item .item[data-v-5c109676]{cursor:pointer;border:1px solid #e0e0e0;display:flex;justify-content:center;align-items:center;height:180px}.address-list .address-item .item .add-desc[data-v-5c109676]{text-align:center;color:#b0b0b0}.address-list .address-item .item .add-desc i[data-v-5c109676]{color:#e0e0e0;font-size:32px;margin-bottom:10px}.address-list .address-item .item:hover i[data-v-5c109676]{color:#b0b0b0}.address-list .address-item .item-on[data-v-5c109676]{cursor:pointer;border:1px solid #e0e0e0;display:flex;height:180px;padding:20px;position:relative}.address-list .address-item .item-on .address-info[data-v-5c109676]{width:100%;font-size:14px;color:#757575}.address-list .address-item .item-on .address-info .name[data-v-5c109676]{font-size:18px;margin-bottom:20px}.address-list .address-item .item-on .address-info .name span[data-v-5c109676]{color:#fa524c;float:right;font-size:12px}.address-list .address-item .item-on .address-info .address-action[data-v-5c109676]{position:absolute;bottom:20px;right:20px;display:none}.address-list .address-item .item-on:hover .address-action[data-v-5c109676]{display:block}.address-list .address-item .item-on.on[data-v-5c109676]{border:1px solid #fa524c}.iframe[data-v-5c109676]{border:1px solid #dcdfe6}",""]),e.exports=n}}]);