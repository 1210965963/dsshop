(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{589:function(e,t,r){"use strict";r.r(t);var n=r(7),o=r(3),c=(r(38),r(49),r(13),r(24),r(26),r(108),r(207)),d=r(206),m=r(12);t.default={layout:"user",head:function(){return{title:"".concat(this.$t("user.info"),"-").concat(this.$t("header.top.personal_center"))}},data:function(){return{disabled:!1,codename:this.$t("find_password.get_code"),seconds:"",unit:"",uploadFile:{url:"http://dsshop.test/api/v1/app/uploadPictures",header:{"apply-secret":"base64:szoJ3mSx/5U7zOsJfU7s4pSahiwdh01x6badmz5FtCM=",Authorization:"Bearer "+Object(m.a)("token")},data:{type:1,size:2097152}},loading:!0,buttonLoading:!1,centerDialogVisible:!1,imgProgressPercent:0,imgProgress:!1,dialogType:"",dialogTitle:"",ruleForm:{},user:{},collectList:[],rules:{portrait:[{required:!0,message:this.$t("userinfo.portrait"),trigger:"blur"}],nickname:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("userinfo.nickname")}),trigger:"blur"}],email:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("userinfo.email")}),trigger:"blur"},{type:"email",message:this.$t("hint.error.wrong_format",{attribute:this.$t("userinfo.email")}),trigger:["blur","change"]}],code:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("find_password.verification_code")}),trigger:"blur"},{type:"number",message:this.$t("find_password.verification_code.number",{attribute:this.$t("find_password.verification_code")})}]}}},mounted:function(){this.getUser()},methods:{getUser:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([Object(c.c)(e.listQuery)]).then((function(t){var r=Object(n.a)(t,1)[0];e.user=r,e.loading=!1})).catch((function(t){e.loading=!1}));case 2:case"end":return t.stop()}}),t)})))()},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.buttonLoading=!0,"email"===e.dialogType?Object(d.i)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:e.$t("common.success"),type:"success"})})).catch((function(){e.buttonLoading=!1})):Object(c.d)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:e.$t("common.success"),type:"success"})})).catch((function(){e.buttonLoading=!1})))}))},modification:function(e){switch(this.centerDialogVisible=!0,this.dialogType=e,e){case"portrait":this.dialogTitle=this.$t("userinfo.amend_portrait"),this.ruleForm={portrait:this.user.portrait};break;case"nickname":this.dialogTitle=this.$t("userinfo.amend_nickname"),this.ruleForm={nickname:this.user.nickname};break;case"email":this.dialogTitle=this.$t("userinfo.amend_email"),this.ruleForm={email:this.user.email,code:""}}},handleAvatarSuccess:function(e,t){this.ruleForm.portrait=t.response,this.imgProgress=!1,this.imgProgressPercent=0},handleProgress:function(e,t){this.imgProgressPercent=e.percent},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return-1===["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?(this.$message.error(this.$t("userinfo.error.image")),!1):(t||this.$message.error(this.$t("userinfo.error.image.size")),this.imgProgress=!0,t)},getCode:function(){var e=this,t=this;this.buttonLoading=!0,Object(d.d)(this.ruleForm).then((function(r){e.seconds=60,e.codename="",e.unit="s",e.disabled=!0,e.buttonLoading=!1,e.timer=setInterval((function(){t.seconds=t.seconds-1,0===t.seconds&&(clearInterval(t.timer),t.seconds="",t.codename=this.$t("find_password.get_code"),t.unit="",t.disabled=!1)}),1e3),r.code&&(t.ruleForm.code=r.code)})).catch((function(){e.buttonLoading=!1}))}}}}}]);