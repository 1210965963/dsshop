(window.webpackJsonp=window.webpackJsonp||[]).push([[17,18],{559:function(t,e,n){"use strict";n.r(e);n(31),n(27),n(55),n(56);var o=n(18),r=n(3),c=(n(38),n(17),n(303),n(208),n(209),n(306),n(30),n(138));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.default={layout:"cart",head:function(){return{title:this.$t("cart.title")+"-DSSHOP商城-轻量级易扩展低代码开源商城系统"}},data:function(){return{loading:!0,cartList:[],cartOriginalList:[],invalidGood:[],total:0,allChecked:!0,empty:!0,multipleSelection:[]}},mounted:function(){$nuxt.$store.commit("setCartTitle",this.$t("cart.title")),$nuxt.$store.state.hasLogin&&this.getList()},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,t.cartList=[],t.invalidGood=[],e.next=5,Object(c.k)().then((function(e){t.store.set("DSSHOP-PC-CartList",e),t.cartOriginalList=e,e.length>0?t.empty=!1:t.empty=!0;var n=function(n){e[n].good_sku&&(e[n].specification="",e[n].good_sku.skus.forEach((function(t){e[n].specification?e[n].specification+=t.v+";":e[n].specification=t.v+";"})),e[n].specification=e[n].specification.substr(0,e[n].specification.length-1)),1!==e[n].good.is_delete&&1===e[n].good.is_show||(e[n].invalid=!0),!0===e[n].invalid?t.invalidGood.push(d(d({},e[n]),{},{index:n})):t.cartList.push(d(d({},e[n]),{},{index:n}))};for(var o in e)n(o);t.$nextTick((function(){!1===t.empty&&t.handleCheckAllChange()})),t.loading=!1})).catch((function(){t.loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},calcTotal:function(){var t=this.multipleSelection,e=0;t.forEach((function(t){e+=t.price*t.number})),this.total=Number(e.toFixed(2))},handleSelectionChange:function(t){this.multipleSelection=t,this.calcTotal()},handleCheckAllChange:function(){this.$refs.table.toggleAllSelection(),this.calcTotal()},createOrder:function(){this.multipleSelection.length<=0?this.$message({message:this.$t("hint.error.selects",{attribute:this.$t("cart.commodity")}),type:"error"}):(this.store.set("DSSHOP-PC-OrderList",this.multipleSelection),$nuxt.$router.push("/indent/create"))},numberChange:function(t){this.cartOriginalList[t].number=this.cartList[t].number,this.store.set("DSSHOP-PC-CartList",this.cartOriginalList),Object(c.a)(this.cartOriginalList),this.calcTotal()},deleteInvalidGood:function(t){var e=this;this.$confirm(this.$t("cart.confirm.title"),this.$t("common.hint"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){e.cartOriginalList.splice(e.invalidGood[t].index,1),Object.values(e.cartOriginalList).length>0?e.store.set("DSSHOP-PC-CartList",e.cartOriginalList):e.store.remove("DSSHOP-PC-CartList"),Object(c.a)(e.cartOriginalList).then((function(){e.getList()})),e.invalidGood.splice(t,1)})).catch((function(){}))},deleteCartItem:function(t){var e=this;this.$confirm(this.$t("cart.confirm.title"),this.$t("common.hint"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){e.cartOriginalList.splice(e.cartList[t].index,1),Object.values(e.cartOriginalList).length>0?e.store.set("DSSHOP-PC-CartList",e.cartOriginalList):e.store.remove("DSSHOP-PC-CartList"),Object(c.a)(e.cartOriginalList).then((function(){e.getList()})),e.cartList.splice(t,1)})).catch((function(){}))},clearCart:function(){var t=this;this.$confirm(this.$t("cart.confirm.title.selected"),this.$t("common.hint"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){t.multipleSelection.forEach((function(e){t.cartList.forEach((function(n,o){e.good_sku_id?e.good_sku_id===n.good_sku_id&&(delete t.cartOriginalList[n.index],t.cartList.splice(o,1)):e.good_id===n.good_id&&(delete t.cartOriginalList[n.index],t.cartList.splice(o,1))}))})),t.cartOriginalList=t.cartOriginalList.filter((function(t){return t})),Object.values(t.cartOriginalList).length>0?t.store.set("DSSHOP-PC-CartList",t.cartOriginalList):t.store.remove("DSSHOP-PC-CartList"),Object(c.a)(t.cartOriginalList).then((function(){t.getList()}))})).catch((function(){}))}}}},560:function(t,e,n){var content=n(615);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(16).default)("7b06a748",content,!0,{sourceMap:!1})},613:function(t,e,n){t.exports=n.p+"img/empty-cart.025b92e.png"},614:function(t,e,n){"use strict";n(560)},615:function(t,e,n){var o=n(15)(!1);o.push([t.i,".invalid-title[data-v-39729906]{padding:20px 0;font-size:26px;color:#ccc;text-align:center}.invalidTable[data-v-39729906]{margin-top:20px}.cart-list[data-v-39729906]{padding:30px 0}.cart-list .specification[data-v-39729906]{color:#999}.cart-operation[data-v-39729906]{margin-top:20px;background-color:#fff;display:flex;line-height:40px;font-size:12px}.cart-operation .left[data-v-39729906]{flex:1;padding-left:20px;color:#757575}.cart-operation .left .delete[data-v-39729906]{cursor:pointer}.cart-operation .left .delete[data-v-39729906]:hover,.cart-operation .left .number[data-v-39729906]{color:#fa524c}.cart-operation .right[data-v-39729906]{width:400px;justify-content:flex-end;display:flex}.cart-operation .right .total[data-v-39729906]{margin-right:30px;color:#fa524c}.cart-operation .right .total span[data-v-39729906]{font-size:28px}.cart-operation .right .settlement[data-v-39729906]{width:150px}.cart[data-v-39729906]{margin-top:100px;margin-bottom:100px;display:flex;position:relative}.cart .empty-cart img[data-v-39729906]{width:500px}.cart .instructions[data-v-39729906]{margin:160px 0 0 50px}.cart .instructions .title[data-v-39729906]{font-size:35px;color:#b0b0b0;line-height:55px;font-weight:700}.cart .instructions .login[data-v-39729906]{font-size:18px;line-height:45px;color:#b0b0b0}.cart .instructions .operation[data-v-39729906]{margin-top:20px}",""]),t.exports=o},670:function(t,e,n){"use strict";n.r(e);var o=n(559).default,r=(n(614),n(10)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box"},[t.empty?[o("div",{staticClass:"cart container"},[o("div",{staticClass:"empty-cart"},[o("img",{attrs:{src:n(613)}})]),t._v(" "),o("div",{staticClass:"instructions"},[o("div",{staticClass:"title"},[t._v(t._s(t.$t("cart.empty")))]),t._v(" "),t.$store.state.hasLogin?t._e():o("div",{staticClass:"login"},[t._v(t._s(t.$t("money.success.after_login")))]),t._v(" "),o("div",{staticClass:"operation"},[t.$store.state.hasLogin?[o("NuxtLink",{staticClass:"li",attrs:{to:"/category/list"}},[o("el-button",{attrs:{type:"danger"}},[t._v(t._s(t.$t("cart.go_shopping")))])],1)]:[o("NuxtLink",{staticClass:"li",attrs:{to:"/pass/login"}},[o("el-button",{attrs:{type:"danger"}},[t._v(t._s(t.$t("cart.login")))])],1),t._v(" "),o("NuxtLink",{staticClass:"li",attrs:{to:"/category/list"}},[o("el-button",{attrs:{type:"danger",plain:""}},[t._v(t._s(t.$t("cart.go_shopping")))])],1)]],2)])])]:[o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cart-list container"},[o("el-table",{ref:"table",staticClass:"table",attrs:{data:t.cartList},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[o("el-image",{staticClass:"image",attrs:{src:t._f("smallImage")(e.row.img,80),fit:"cover"}})],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.name")},scopedSlots:t._u([{key:"default",fn:function(e){return[o("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[o("p",[t._v(t._s(e.row.name))]),t._v(" "),o("p",{staticClass:"specification"},[t._v(t._s(e.row.specification))])])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.price"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t._f("thousands")(e.row.price))+"\n          ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.number"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-input-number",{attrs:{size:"mini",min:1,max:e.row.good_sku.inventory},on:{change:function(n){return t.numberChange(e.$index)}},model:{value:e.row.number,callback:function(n){t.$set(e.row,"number",n)},expression:"scope.row.number"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.subtotal"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t._f("thousands")(e.row.price*e.row.number))+"\n          ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("common.operation"),width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("cart.remove_goods"),placement:"top-start"}},[o("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return n.stopPropagation(),t.deleteCartItem(e.$index)}}})],1)]}}])})],1),t._v(" "),o("div",{staticClass:"cart-operation"},[o("div",{staticClass:"left"},[o("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:t.handleCheckAllChange}},[t._v(t._s(t.$t("notice.select_reverse")))]),t._v(" "),o("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),o("span",{staticClass:"delete",on:{click:t.clearCart}},[t._v(t._s(t.$t("common.delete")))]),t._v(" "),o("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),o("span",[t._v(t._s(t.$t("cart.common"))+" "),o("span",{staticClass:"number"},[t._v(t._s(t.cartList.length))]),t._v(" "+t._s(t.$t("cart.pieces_goods"))+"，"+t._s(t.$t("common.selected"))+" "),o("span",{staticClass:"number"},[t._v(t._s(t.multipleSelection.length))]),t._v(t._s(t.$t("good_indent.piece")))])],1),t._v(" "),o("div",{staticClass:"right"},[o("div",{staticClass:"total"},[t._v(t._s(t.$t("cart.total"))+"："),o("span",[t._v(t._s(t.total))]),t._v(t._s(t.$t("common.monetary_unit")))]),t._v(" "),o("el-button",{staticClass:"settlement",attrs:{type:"danger",disabled:t.total<=0},on:{click:t.createOrder}},[t._v(t._s(t.$t("cart.settle")))])],1)]),t._v(" "),t.invalidGood.length?[o("h3",{staticClass:"invalid-title"},[t._v(t._s(t.$t("cart.invalid_commodity")))]),t._v(" "),o("el-table",{ref:"invalidTable",staticClass:"invalidTable",attrs:{data:t.invalidGood}},[o("el-table-column",{attrs:{align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[o("el-image",{staticClass:"image",attrs:{src:t._f("smallImage")(e.row.img,80),fit:"cover"}})],1)]}}],null,!1,138529428)}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.name")},scopedSlots:t._u([{key:"default",fn:function(e){return[o("NuxtLink",{attrs:{to:{path:"/product/detail/"+e.row.good_id}}},[o("p",[t._v(t._s(e.row.name))]),t._v(" "),o("p",{staticClass:"specification"},[t._v(t._s(e.row.specification))])])]}}],null,!1,270465265)}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.price"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("thousands")(e.row.price))+"\n            ")]}}],null,!1,912411108)}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.number"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.number)+"\n            ")]}}],null,!1,4147131710)}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("indent.subtotal"),width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("thousands")(e.row.price*e.row.number))+"\n            ")]}}],null,!1,1182163340)}),t._v(" "),o("el-table-column",{attrs:{label:t.$t("common.operation"),width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("cart.remove_goods"),placement:"top-start"}},[o("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return t.deleteInvalidGood(e.$index)}}})],1)]}}],null,!1,3616010465)})],1)]:t._e()],2)]],2)}),[],!1,null,"39729906",null);e.default=component.exports}}]);