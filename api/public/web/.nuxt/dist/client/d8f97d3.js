(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{534:function(t,e,n){"use strict";n.d(e,"f",(function(){return d})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return m})),n.d(e,"e",(function(){return f})),n.d(e,"b",(function(){return $}));var r=n(6),o=n(22),c=n.n(o);function d(t){return Object(r.a)({url:"shipping",method:"GET",params:t})}function l(data){return data=c.a.parse(data),Object(r.a)({url:"shipping",method:"POST",data:data})}function h(data){return data=c.a.parse(data),Object(r.a)({url:"shipping/"+data.id,method:"POST",data:data})}function m(t){return Object(r.a)({url:"shipping/destroy/"+t,method:"POST"})}function f(t,data){return data=c.a.parse(data),Object(r.a)({url:"shipping/freight/"+t,method:"POST",data:data})}function $(data){return data=c.a.parse(data),Object(r.a)({url:"shipping/default/set",method:"POST",data:data})}},535:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(38),n(17),n(534));e.default={name:"AddressList",props:{select:{type:Boolean,default:!1}},data:function(){var t=this;return{src:"https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=lbs_qq_key&referer=myapp",restaurants:[],buttonLoading:!1,loading:!1,dialogTitle:this.$t("address.add"),centerDialogVisible:!1,list:[],ruleForm:{location:"",address:"",name:"",house:"",cellphone:"",latitude:"",longitude:""},rules:{name:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("address.name")}),trigger:"blur"}],cellphone:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("find_password.cellphone")}),trigger:"blur"},{validator:function(e,n,r){if(""===n)r(new Error(t.$t("hint.error.import",{attribute:t.$t("find_password.cellphone")})));else{/^(((13[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/.test(n)||r(new Error(t.$t("hint.error.wrong_format",{attribute:t.$t("find_password.cellphone")}))),r()}},trigger:"blur"}],house:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("address.house")}),trigger:"blur"}]}}},watch:{},mounted:function(){this.getList(),window.addEventListener("message",this.handleSelect)},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,Object(o.f)({sort:"-defaults"}).then((function(e){t.loading=!1,t.list=e.data,t.list.forEach((function(e){e.defaults?(e.on=!0,t.$emit("selectedAddress",e)):e.on=!1}))})).catch((function(){t.loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},switchAddress:function(t){this.select&&(this.list.forEach((function(t){t.on=!1})),t.on=!0,this.$emit("selectedAddress",t),this.$forceUpdate())},submitForm:function(){var t=this;this.$refs.ruleForm.validate((function(e){e&&(t.buttonLoading=!0,t.ruleForm.id?Object(o.d)(t.ruleForm).then((function(e){t.buttonLoading=!1,t.centerDialogVisible=!1,t.$refs.ruleForm.resetFields(),t.getList(),t.$message({message:t.$t("hint.succeed.win",{attribute:t.$t("common.amend")}),type:"success"})})).catch((function(){t.buttonLoading=!1})):(t.ruleForm.longitude||t.$message.error(t.$t("hint.error.selects",{attribute:t.$t("address.location")})),Object(o.a)(t.ruleForm).then((function(e){t.buttonLoading=!1,t.centerDialogVisible=!1,t.$refs.ruleForm.resetFields(),t.getList(),t.$message({message:t.$t("hint.succeed.win",{attribute:t.$t("common.add")}),type:"success"})})).catch((function(){t.buttonLoading=!1}))))}))},defaultAddress:function(t){var e=this;this.$confirm(this.$t("address.is_default"),this.$t("common.hint"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){e.buttonLoading=!0,Object(o.b)(t).then((function(t){e.buttonLoading=!1,e.getList(),e.$message({message:e.$t("common.success"),type:"success"})})).catch((function(){e.buttonLoading=!1}))})).catch((function(){}))},deleteAddress:function(t){var e=this;t.defaults?this.$message({message:this.$t("address.delete.confirm"),type:"error"}):this.$confirm(this.$t("address.delete.title"),this.$t("common.hint"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){e.buttonLoading=!0,Object(o.c)(t.id).then((function(t){e.buttonLoading=!1,e.getList(),e.$message({message:e.$t("hint.succeed.win",{attribute:e.$t("common.delete")}),type:"success"})})).catch((function(){e.buttonLoading=!1}))})).catch((function(){}))},updateAddress:function(t){t.id?(this.ruleForm=t,this.dialogTitle=this.$t("address.amend")):(this.ruleForm={location:"",address:"",name:"",house:"",cellphone:"",latitude:"",longitude:""},this.dialogTitle=this.$t("address.add")),this.centerDialogVisible=!0},handleSelect:function(t){var e=t.data;e&&"locationPicker"===e.module&&(this.ruleForm.location=e.poiname,this.ruleForm.address=e.poiaddress,this.ruleForm.longitude=e.latlng.lng,this.ruleForm.latitude=e.latlng.lat)}}}}}]);