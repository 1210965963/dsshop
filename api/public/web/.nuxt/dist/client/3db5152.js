(window.webpackJsonp=window.webpackJsonp||[]).push([[62,55],{557:function(e,t,r){e.exports=r.p+"img/portrait.2250589.gif"},589:function(e,t,r){"use strict";r.r(t);var o=r(7),n=r(3),l=(r(38),r(49),r(13),r(24),r(26),r(108),r(207)),c=r(206),d=r(12);t.default={layout:"user",head:function(){return{title:"".concat(this.$t("user.info"),"-").concat(this.$t("header.top.personal_center"))}},data:function(){return{disabled:!1,codename:this.$t("find_password.get_code"),seconds:"",unit:"",uploadFile:{url:"http://dsshop.test/api/v1/app/uploadPictures",header:{"apply-secret":"base64:szoJ3mSx/5U7zOsJfU7s4pSahiwdh01x6badmz5FtCM=",Authorization:"Bearer "+Object(d.a)("token")},data:{type:1,size:2097152}},loading:!0,buttonLoading:!1,centerDialogVisible:!1,imgProgressPercent:0,imgProgress:!1,dialogType:"",dialogTitle:"",ruleForm:{},user:{},collectList:[],rules:{portrait:[{required:!0,message:this.$t("userinfo.portrait"),trigger:"blur"}],nickname:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("userinfo.nickname")}),trigger:"blur"}],email:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("userinfo.email")}),trigger:"blur"},{type:"email",message:this.$t("hint.error.wrong_format",{attribute:this.$t("userinfo.email")}),trigger:["blur","change"]}],code:[{required:!0,message:this.$t("hint.error.import",{attribute:this.$t("find_password.verification_code")}),trigger:"blur"},{type:"number",message:this.$t("find_password.verification_code.number",{attribute:this.$t("find_password.verification_code")})}]}}},mounted:function(){this.getUser()},methods:{getUser:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([Object(l.c)(e.listQuery)]).then((function(t){var r=Object(o.a)(t,1)[0];e.user=r,e.loading=!1})).catch((function(t){e.loading=!1}));case 2:case"end":return t.stop()}}),t)})))()},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.buttonLoading=!0,"email"===e.dialogType?Object(c.i)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:e.$t("common.success"),type:"success"})})).catch((function(){e.buttonLoading=!1})):Object(l.d)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:e.$t("common.success"),type:"success"})})).catch((function(){e.buttonLoading=!1})))}))},modification:function(e){switch(this.centerDialogVisible=!0,this.dialogType=e,e){case"portrait":this.dialogTitle=this.$t("userinfo.amend_portrait"),this.ruleForm={portrait:this.user.portrait};break;case"nickname":this.dialogTitle=this.$t("userinfo.amend_nickname"),this.ruleForm={nickname:this.user.nickname};break;case"email":this.dialogTitle=this.$t("userinfo.amend_email"),this.ruleForm={email:this.user.email,code:""}}},handleAvatarSuccess:function(e,t){this.ruleForm.portrait=t.response,this.imgProgress=!1,this.imgProgressPercent=0},handleProgress:function(e,t){this.imgProgressPercent=e.percent},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return-1===["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?(this.$message.error(this.$t("userinfo.error.image")),!1):(t||this.$message.error(this.$t("userinfo.error.image.size")),this.imgProgress=!0,t)},getCode:function(){var e=this,t=this;this.buttonLoading=!0,Object(c.d)(this.ruleForm).then((function(r){e.seconds=60,e.codename="",e.unit="s",e.disabled=!0,e.buttonLoading=!1,e.timer=setInterval((function(){t.seconds=t.seconds-1,0===t.seconds&&(clearInterval(t.timer),t.seconds="",t.codename=this.$t("find_password.get_code"),t.unit="",t.disabled=!1)}),1e3),r.code&&(t.ruleForm.code=r.code)})).catch((function(){e.buttonLoading=!1}))}}}},590:function(e,t,r){var content=r(647);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(15).default)("d9345aac",content,!0,{sourceMap:!1})},646:function(e,t,r){"use strict";r(590)},647:function(e,t,r){var o=r(14)(!1);o.push([e.i,".portrait[data-v-211ab290]{cursor:pointer}.ruleForm[data-v-211ab290]{width:500px}.ruleForm .avatar-uploader-icon[data-v-211ab290]{line-height:190px;margin:auto}.ruleForm .code-button[data-v-211ab290]{position:absolute;right:5px;top:6px}.ruleForm a[data-v-211ab290]{position:relative;top:-1px}.user-title[data-v-211ab290]{color:#757575;font-weight:400;font-size:18px;margin-bottom:20px}",""]),e.exports=o},685:function(e,t,r){"use strict";r.r(t);var o=r(589).default,n=(r(646),r(10)),component=Object(n.a)(o,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"box"},[o("div",{staticClass:"user-title"},[e._v(e._s(e.$t("user.info")))]),e._v(" "),o("div",{staticClass:"padding-top-20"},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"200px"}},[o("el-form-item",{attrs:{label:e.$t("userinfo.head_portrait"),prop:"portrait"}},[o("el-avatar",{attrs:{size:80}},[o("img",{staticClass:"portrait",attrs:{src:e.user.portrait?e.user.portrait:r(557)},on:{click:function(t){return e.modification("portrait")}}})])],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("userinfo.nickname"),prop:"nickname"}},[o("span",[e._v(e._s(e.user.nickname?e.user.nickname:e.$t("userinfo.not_set")))]),e._v(" "),o("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.modification("nickname")}}},[e._v(e._s(e.$t("common.amend")))])],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("userinfo.email"),prop:"email"}},[o("span",[e._v(e._s(e.user.email?e.user.email:e.$t("userinfo.not_bound")))]),e._v(" "),o("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.modification("email")}}},[e._v(e._s(e.$t("common.amend")))])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.dialogTitle,visible:e.centerDialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[o("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},["portrait"===e.dialogType?[o("el-form-item",{attrs:{label:e.$t("userinfo.head_portrait"),prop:"portrait"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"on-progress":e.handleProgress,action:e.uploadFile.url,headers:e.uploadFile.header,data:e.uploadFile.data}},[e.imgProgress?o("span",[o("el-progress",{staticClass:"progress-img",attrs:{percentage:e.imgProgressPercent,type:"circle"}})],1):o("span",[e.ruleForm.portrait?o("img",{staticClass:"avatar",attrs:{src:e.ruleForm.portrait}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("hint.tip.upload",{rmvb:"jpg/png/gif",size:"2M"})))])])],1)]:"nickname"===e.dialogType?[o("el-form-item",{attrs:{label:e.$t("userinfo.nickname"),prop:"nickname"}},[o("el-input",{attrs:{maxlength:"30",placeholder:e.$t("hint.error.import",{attribute:e.$t("userinfo.nickname")}),clearable:""},model:{value:e.ruleForm.nickname,callback:function(t){e.$set(e.ruleForm,"nickname",t)},expression:"ruleForm.nickname"}})],1)]:[o("el-form-item",{attrs:{label:e.$t("userinfo.email"),prop:"email"}},[o("el-input",{attrs:{maxlength:"255",placeholder:e.$t("hint.error.import",{attribute:e.$t("userinfo.email")}),clearable:""},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("find_password.verification_code"),prop:"code"}},[o("el-input",{attrs:{maxlength:"5",placeholder:e.$t("hint.error.import",{attribute:e.$t("find_password.verification_code")}),clearable:""},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",e._n(t))},expression:"ruleForm.code"}}),e._v(" "),o("el-button",{staticClass:"code-button",attrs:{loading:e.buttonLoading,type:"danger",round:"",size:"mini",disabled:e.disabled},on:{click:e.getCode}},[e._v(e._s(e.codename+e.seconds+e.unit))])],1)]],2),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{loading:e.buttonLoading},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),o("el-button",{attrs:{loading:e.buttonLoading,type:"danger"},on:{click:e.submitForm}},[e._v(e._s(e.$t("common.confirm")))])],1)],1)],1)}),[],!1,null,"211ab290",null);t.default=component.exports}}]);