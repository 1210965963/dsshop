(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{506:function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return m}));var n=r(8),o=r(19),c=r.n(o);function d(){return Object(n.a)({url:"user",method:"GET"})}function l(data){return data=c.a.parse(data),Object(n.a)({url:"user",method:"POST",data:data})}function m(data){return data=c.a.parse(data),Object(n.a)({url:"cancel",method:"POST",data:data})}},749:function(e,t,r){"use strict";r.r(t);var n=r(17),o=r(7),c=(r(36),r(13),r(24),r(30),r(91),r(506)),d=r(188),l=r(9);t.default={layout:"user",head:function(){return{title:"个人资料-个人中心"}},data:function(){return{disabled:!1,codename:"获取验证码",seconds:"",unit:"",uploadFile:{url:"http://dsshop.test/api/v1/app/uploadPictures",header:{"apply-secret":"base64:szoJ3mSx/5U7zOsJfU7s4pSahiwdh01x6badmz5FtCM=",Authorization:"Bearer "+Object(l.a)("token")},data:{type:1,size:2097152}},loading:!0,buttonLoading:!1,centerDialogVisible:!1,imgProgressPercent:0,imgProgress:!1,dialogType:"",dialogTitle:"",ruleForm:{},user:{},collectList:[],rules:{portrait:[{required:!0,message:"请上传头像",trigger:"blur"}],nickname:[{required:!0,message:"请设置昵称",trigger:"blur"}],email:[{required:!0,message:"请设置邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{type:"number",message:"验证码必须为数字"}]}}},mounted:function(){this.getUser()},methods:{getUser:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([Object(c.b)(e.listQuery)]).then((function(t){var r=Object(n.a)(t,1)[0];e.user=r,e.loading=!1})).catch((function(t){e.loading=!1}));case 2:case"end":return t.stop()}}),t)})))()},submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.buttonLoading=!0,"email"===e.dialogType?Object(d.i)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:"保存成功",type:"success"})})).catch((function(){e.buttonLoading=!1})):Object(c.c)(e.ruleForm).then((function(t){e.buttonLoading=!1,e.centerDialogVisible=!1,e.getUser(),e.$message({message:"保存成功",type:"success"})})).catch((function(){e.buttonLoading=!1})))}))},modification:function(e){switch(this.centerDialogVisible=!0,this.dialogType=e,e){case"portrait":this.dialogTitle="修改头像",this.ruleForm={portrait:this.user.portrait};break;case"nickname":this.dialogTitle="修改昵称",this.ruleForm={nickname:this.user.nickname};break;case"email":this.dialogTitle="修改邮箱",this.ruleForm={email:this.user.email,code:""}}},handleAvatarSuccess:function(e,t){this.ruleForm.portrait=t.response,this.imgProgress=!1,this.imgProgressPercent=0},handleProgress:function(e,t){this.imgProgressPercent=e.percent},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return-1===["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?(this.$message.error("请上传正确的图片格式"),!1):(t||this.$message.error("上传头像图片大小不能超过 2MB!"),this.imgProgress=!0,t)},getCode:function(){var e=this,t=this;this.buttonLoading=!0,Object(d.d)(this.ruleForm).then((function(r){e.seconds=60,e.codename="",e.unit="s",e.disabled=!0,e.buttonLoading=!1,e.timer=setInterval((function(){t.seconds=t.seconds-1,0===t.seconds&&(clearInterval(t.timer),t.seconds="",t.codename="获取验证码",t.unit="",t.disabled=!1)}),1e3),r.code&&(t.ruleForm.code=r.code)})).catch((function(){e.buttonLoading=!1}))}}}}}]);