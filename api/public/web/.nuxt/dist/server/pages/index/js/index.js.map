{"version":3,"file":"pages/index/js/index.js","sources":["webpack:///./api/good.js","webpack:///./pages/index/js/index.js"],"sourcesContent":["import request from '@/plugins/request'\r\nexport function getList(query) {\r\n  return request({\r\n    url: 'good',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\nexport function detail(id) {\r\n  return request({\r\n    url: 'good/' + id,\r\n    method: 'GET'\r\n  })\r\n}\r\nexport function goodCategory(query) {\r\n  return request({\r\n    url: 'goodCategory',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\n","import {getList as getGoodList, goodCategory} from '@/api/good'\r\nimport {getList as bannerList} from '@/api/banner'\r\nexport default {\r\n  data() {\r\n    return {\r\n      categoryStyle: 0,\r\n      naveOn: null,\r\n      goodList: [],\r\n      banner: '',\r\n      bannerList: [],\r\n      categoryList: [],\r\n      categorySublevel:[],\r\n      recommendCategoryList: [],\r\n      recommendGoodList: []\r\n    }\r\n  },\r\n  async asyncData (ctx) {\r\n    try {\r\n      let [goodData, bannerData, categoryData, recommendCategoryData] = await Promise.all([\r\n        getGoodList({\r\n          limit: 10,\r\n          is_recommend: 1\r\n        }),\r\n        bannerList({\r\n          limit: 5,\r\n          type: 0,\r\n          state: 0,\r\n          sort: '+sort'\r\n        }),\r\n        goodCategory({\r\n          tree: true\r\n        }),\r\n        goodCategory({\r\n          is_recommend: 1\r\n        })\r\n      ])\r\n      bannerData.data.forEach(item=>{\r\n        item.url = item.url ? item.url.replace('?id=','/') : ''\r\n      })\r\n      return {\r\n        goodList: goodData.data,\r\n        bannerList: bannerData.data,\r\n        categoryList: categoryData,\r\n        recommendCategoryList: recommendCategoryData,\r\n      }\r\n    } catch(err) {\r\n      ctx.$errorHandler(err)\r\n    }\r\n  },\r\n  mounted() {\r\n    this.categoryGood();\r\n    this.getBanner()\r\n  },\r\n  methods: {\r\n    // 分类切换\r\n    naveCut(index){\r\n      if(index !== -1){\r\n        this.naveOn = index;\r\n        if(this.categoryList[index].children){ //存在子类目\r\n          if(this.categoryList[index].children[0].resources){\r\n            this.categorySublevel = this.categoryList[index].children;\r\n            this.categoryStyle = 2\r\n          }else{  //存在三级\r\n            this.categorySublevel = this.categoryList[index].children;\r\n            this.categoryStyle = 1\r\n          }\r\n        }else{\r\n          this.categorySublevel = []\r\n        }\r\n      }\r\n    },\r\n    // 获取分类商品\r\n    categoryGood() {\r\n      this.recommendCategoryList.forEach((item,index)=>{\r\n        this.recommendGoodList[index] = []\r\n        getGoodList({\r\n          limit: 10,\r\n          category_id: item.id\r\n        }).then(response => {\r\n          this.recommendGoodList[index] = response.data\r\n          this.$forceUpdate()\r\n        })\r\n      })\r\n    },\r\n    // 分类移出\r\n    naveShiftOut(){\r\n      this.naveOn = null;\r\n      this.categoryStyle = 0\r\n    },\r\n    // 首页广告\r\n    getBanner(){\r\n      bannerList({\r\n        limit: 1,\r\n        type: 1,\r\n        state: 0,\r\n        sort: '+sort'\r\n      }).then(response => {\r\n        this.banner = response.data[0]\r\n        if(this.banner){\r\n          this.banner.url = this.banner.url ? this.banner.url.replace('?id=','/') : ''\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;ACpBA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAJA;AAOA;AADA;AAIA;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAlDA;AAnDA;;;;A","sourceRoot":""}