{"version":3,"file":"pages/index/js/index.js","sources":["webpack:///./api/good.js","webpack:///./api/banner.js","webpack:///./pages/index/js/index.js"],"sourcesContent":["import request from '@/plugins/request'\r\nexport function getList(query) {\r\n  return request({\r\n    url: 'good',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\nexport function detail(id) {\r\n  return request({\r\n    url: 'good/' + id,\r\n    method: 'GET'\r\n  })\r\n}\r\nexport function goodCategory(query) {\r\n  return request({\r\n    url: 'goodCategory',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\n","import request from '@/plugins/request'\r\nexport function getList(query) {\r\n  return request({\r\n    url: 'banner',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\n","import {getList as getGoodList, goodCategory} from '@/api/good'\nimport {getList as bannerList} from '@/api/banner'\nexport default {\n  data() {\n    return {\n      categoryStyle: 0,\n      naveOn: null,\n      goodList: [],\n      banner: '',\n      bannerList: [],\n      categoryList: [],\n      categorySublevel:[],\n      recommendCategoryList: [],\n      recommendGoodList: [],\n    }\n  },\n  async asyncData (ctx) {\n    try {\n      let [goodData, bannerData, categoryData, recommendCategoryData] = await Promise.all([\n        getGoodList({\n          limit: 10,\n          is_recommend: 1\n        }),\n        bannerList({\n          limit: 5,\n          type: 0,\n          state: 0,\n          sort: '+sort'\n        }),\n        goodCategory({\n          tree: true\n        }),\n        goodCategory({\n          is_recommend: 1\n        }),\n      ])\n      bannerData.data.forEach(item=>{\n        item.url = item.url ? item.url.replace('?id=','/') : ''\n      })\n      return {\n        goodList: goodData.data,\n        bannerList: bannerData.data,\n        categoryList: categoryData,\n        recommendCategoryList: recommendCategoryData\n      }\n    } catch(err) {\n      ctx.$errorHandler(err)\n    }\n  },\n  mounted() {\n    this.categoryGood();\n    this.getBanner()\n  },\n  methods: {\n    // 分类切换\n    naveCut(index){\n      if(index !== -1){\n        this.naveOn = index;\n        if(this.categoryList[index].children){ //存在子类目\n          if(this.categoryList[index].children[0].resources){\n            this.categorySublevel = this.categoryList[index].children;\n            this.categoryStyle = 2\n          }else{  //存在三级\n            this.categorySublevel = this.categoryList[index].children;\n            this.categoryStyle = 1\n          }\n        }else{\n          this.categorySublevel = []\n        }\n      }\n    },\n    // 获取分类商品\n    categoryGood() {\n      this.recommendCategoryList.forEach((item,index)=>{\n        this.recommendGoodList[index] = []\n        getGoodList({\n          limit: 10,\n          category_id: item.id\n        }).then(response => {\n          this.recommendGoodList[index] = response.data\n          this.$forceUpdate()\n        })\n      })\n    },\n    // 分类移出\n    naveShiftOut(){\n      this.naveOn = null;\n      this.categoryStyle = 0\n    },\n    // 首页广告\n    getBanner(){\n      bannerList({\n        limit: 1,\n        type: 1,\n        state: 0,\n        sort: '+sort'\n      }).then(response => {\n        this.banner = response.data[0]\n        this.banner.url = this.banner.url ? this.banner.url.replace('?id=','/') : ''\n      })\n    }\n  }\n}\n"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;;;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAJA;AAOA;AADA;AAIA;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAhDA;AAnDA;;;;A","sourceRoot":""}