{"version":3,"file":"pages/user/notice/js/list.js","sources":["webpack:///./api/notification.js","webpack:///./pages/user/notice/js/list.js"],"sourcesContent":["/** +----------------------------------------------------------------------\r\n * | DSSHOP [ 轻量级易扩展低代码开源商城系统 ]\r\n * +----------------------------------------------------------------------\r\n * | Copyright (c) 2020~2023 https://www.dswjcms.com All rights reserved.\r\n * +----------------------------------------------------------------------\r\n * | Licensed 未经许可不能去掉DSSHOP相关版权\r\n * +----------------------------------------------------------------------\r\n * | Author: Purl <383354826@qq.com>\r\n * +----------------------------------------------------------------------\r\n */\r\nimport request from '@/plugins/request'\r\nimport Qs from 'qs'\r\nexport function getList(query) {\r\n  return request({\r\n    url: 'notification',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\nexport function detail(id) {\r\n  return request({\r\n    url: 'notification/detail/' + id,\r\n    method: 'GET'\r\n  })\r\n}\r\nexport function unread(query) {\r\n  return request({\r\n    url: 'notification/unread',\r\n    method: 'GET',\r\n    params: query\r\n  })\r\n}\r\nexport function read(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'notification/read/0',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\nexport function destroy(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'notification/destroy/0',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\n","import {getList, destroy, read} from '@/api/notification'\r\nexport default {\r\n  layout: 'user',\r\n  head () {\r\n    return {\r\n      title: `${this.$t('header.top.message')}-${this.$t('header.top.personal_center')}`,\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tableLoading: false,\r\n      checkboxAll: false,\r\n      loading: true,\r\n      buttonLoading: false,\r\n      noticeList: [],\r\n      total: 0,\r\n      listQuery: {\r\n        limit: 10,\r\n        page: 1,\r\n        sort: '-created_at',\r\n        pc: true\r\n      },\r\n      multipleSelection: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    async getList(){\r\n      this.tableLoading = true;\r\n      await Promise.all([\r\n        getList(this.listQuery)\r\n      ]).then(([notificationData]) => {\r\n        this.noticeList = notificationData.data;\r\n        this.total = notificationData.total;\r\n        this.loading = false;\r\n        this.tableLoading = false\r\n      }).catch((error) => {\r\n        this.loading = false;\r\n        this.tableLoading = false\r\n      })\r\n    },\r\n    handleCheckAllChange() {\r\n      this.$refs.table.toggleAllSelection()\r\n    },\r\n    handleSelectionChange(val){\r\n      this.multipleSelection = val\r\n    },\r\n    handleAllDelete() { // 批量删除\r\n      if(this.multipleSelection.length === 0){\r\n        this.$message({\r\n          message: this.$t('notice.all_delete'),\r\n          type: 'error'\r\n        });\r\n        return false\r\n      }\r\n      this.$confirm(this.$t('hint.whether_confirm', {attribute:this.$t('common.delete') }), this.$t('common.hint'), {\r\n        confirmButtonText: this.$t('common.confirm'),\r\n        cancelButtonText: this.$t('common.cancel'),\r\n        type: 'warning'\r\n      }).then(() => {\r\n        this.buttonLoading = true;\r\n        destroy(this.multipleSelection).then(response => {\r\n          this.buttonLoading = false;\r\n          this.handleFilter();\r\n          this.$message({\r\n            message: this.$t('common.success'),\r\n            type: 'success'\r\n          });\r\n        }).catch(() => {\r\n          this.buttonLoading = false\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    handleAllRead() { // 批量标记为已读\r\n      if(this.multipleSelection.length === 0){\r\n        this.$message({\r\n          message: this.$t('notice.all_delete'),\r\n          type: 'error'\r\n        });\r\n        return false\r\n      }\r\n      this.buttonLoading = true\r\n      read(this.multipleSelection).then(response => {\r\n        this.buttonLoading = false;\r\n        this.getList();\r\n        this.$message({\r\n          message: this.$t('common.success'),\r\n          type: 'success'\r\n        });\r\n      }).catch(() => {\r\n        this.buttonLoading = false\r\n      })\r\n    },\r\n    sortChange(data) {\r\n      const { prop, order } = data;\r\n      if (order === 'ascending') {\r\n        this.listQuery.sort = '+' + prop\r\n      } else if(order === 'descending') {\r\n        this.listQuery.sort = '-' + prop\r\n      }else{\r\n        this.listQuery.sort = null\r\n      }\r\n      this.handleFilter()\r\n    },\r\n    handleFilter() {\r\n      this.listQuery.page = 1;\r\n      this.getList()\r\n    },\r\n  }\r\n}\r\n"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC/CA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}