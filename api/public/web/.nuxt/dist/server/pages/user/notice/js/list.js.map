{"version":3,"file":"pages/user/notice/js/list.js","sources":["webpack:///./api/notification.js","webpack:///./pages/user/notice/js/list.js"],"sourcesContent":["/** +----------------------------------------------------------------------\n * | DSSHOP [ 轻量级易扩展低代码开源商城系统 ]\n * +----------------------------------------------------------------------\n * | Copyright (c) 2020~2023 https://www.dswjcms.com All rights reserved.\n * +----------------------------------------------------------------------\n * | Licensed 未经许可不能去掉DSSHOP相关版权\n * +----------------------------------------------------------------------\n * | Author: Purl <383354826@qq.com>\n * +----------------------------------------------------------------------\n */\nimport request from '@/plugins/request'\nimport Qs from 'qs'\nexport function getList(query) {\n  return request({\n    url: 'notification',\n    method: 'GET',\n    params: query\n  })\n}\nexport function detail(id) {\n  return request({\n    url: 'notification/detail/' + id,\n    method: 'GET'\n  })\n}\nexport function unread(query) {\n  return request({\n    url: 'notification/unread',\n    method: 'GET',\n    params: query\n  })\n}\nexport function read(data) {\n  data = Qs.parse(data)\n  return request({\n    url: 'notification/read/0',\n    method: 'POST',\n    data\n  })\n}\nexport function destroy(data) {\n  data = Qs.parse(data)\n  return request({\n    url: 'notification/destroy/0',\n    method: 'POST',\n    data\n  })\n}\n","import {getList, destroy, read} from '@/api/notification'\nexport default {\n  layout: 'user',\n  head () {\n    return {\n      title: `${this.$t('header.top.message')}-${this.$t('header.top.personal_center')}`,\n    }\n  },\n  data() {\n    return {\n      tableLoading: false,\n      checkboxAll: false,\n      loading: true,\n      buttonLoading: false,\n      noticeList: [],\n      total: 0,\n      listQuery: {\n        limit: 10,\n        page: 1,\n        sort: '-created_at',\n        pc: true\n      },\n      multipleSelection: []\n    }\n  },\n  mounted() {\n    this.getList()\n  },\n  methods: {\n    async getList(){\n      this.tableLoading = true;\n      await Promise.all([\n        getList(this.listQuery)\n      ]).then(([notificationData]) => {\n        this.noticeList = notificationData.data;\n        this.total = notificationData.total;\n        this.loading = false;\n        this.tableLoading = false\n      }).catch((error) => {\n        this.loading = false;\n        this.tableLoading = false\n      })\n    },\n    handleCheckAllChange() {\n      this.$refs.table.toggleAllSelection()\n    },\n    handleSelectionChange(val){\n      this.multipleSelection = val\n    },\n    handleAllDelete() { // 批量删除\n      if(this.multipleSelection.length === 0){\n        this.$message({\n          message: this.$t('notice.all_delete'),\n          type: 'error'\n        });\n        return false\n      }\n      this.$confirm(this.$t('hint.whether_confirm', {attribute:this.$t('common.delete') }), this.$t('common.hint'), {\n        confirmButtonText: this.$t('common.confirm'),\n        cancelButtonText: this.$t('common.cancel'),\n        type: 'warning'\n      }).then(() => {\n        this.buttonLoading = true;\n        destroy(this.multipleSelection).then(response => {\n          this.buttonLoading = false;\n          this.handleFilter();\n          this.$message({\n            message: this.$t('common.success'),\n            type: 'success'\n          });\n        }).catch(() => {\n          this.buttonLoading = false\n        })\n      }).catch(() => {\n      })\n    },\n    handleAllRead() { // 批量标记为已读\n      if(this.multipleSelection.length === 0){\n        this.$message({\n          message: this.$t('notice.all_delete'),\n          type: 'error'\n        });\n        return false\n      }\n      this.buttonLoading = true\n      read(this.multipleSelection).then(response => {\n        this.buttonLoading = false;\n        this.getList();\n        this.$message({\n          message: this.$t('common.success'),\n          type: 'success'\n        });\n      }).catch(() => {\n        this.buttonLoading = false\n      })\n    },\n    sortChange(data) {\n      const { prop, order } = data;\n      if (order === 'ascending') {\n        this.listQuery.sort = '+' + prop\n      } else if(order === 'descending') {\n        this.listQuery.sort = '-' + prop\n      }else{\n        this.listQuery.sort = null\n      }\n      this.handleFilter()\n    },\n    handleFilter() {\n      this.listQuery.page = 1;\n      this.getList()\n    },\n  }\n}\n"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC/CA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}