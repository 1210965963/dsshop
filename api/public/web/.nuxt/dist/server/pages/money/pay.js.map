{"version":3,"file":"pages/money/pay.js","sources":["webpack:///./pages/money/pay.vue?4794","webpack:///./api/pay.js","webpack:///./pages/money/js/pay.js","webpack:///./assets/img/weixin-pay.jpg","webpack:///./pages/money/pay.vue?42ef","webpack:///./pages/money/pay.vue?6c42","webpack:///./pages/money/pay.vue?4475","webpack:///./pages/money/pay.vue","webpack:///./pages/money/pay.vue?3f5f","webpack:///./pages/money/pay.vue?b061"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./pay.vue?vue&type=style&index=0&id=40e52894&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"7b4ed3f0\", content, true, context)\n};","import request from '@/plugins/request'\r\nimport Qs from 'qs'\r\nexport function unifiedPayment(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'unifiedPayment',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\nexport function balancePay(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'balancePay',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\n","import { pay } from '@/api/goodIndent'\r\nimport { unifiedPayment, balancePay } from '@/api/pay'\r\nimport VueCountdown from '@chenfengyuan/vue-countdown';\r\nimport VueQrcode from '@chenfengyuan/vue-qrcode';\r\nexport default {\r\n  components: { VueCountdown, VueQrcode },\r\n  layout: 'cart',\r\n  middleware: 'auth',\r\n  head () {\r\n    return {\r\n      title: '支付订单' + '-' + process.env.APP_NAME,\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      detail: false,\r\n      centerDialogVisible: false,\r\n      buttonLoading: false,\r\n      qrcode: '',\r\n      timer: null,\r\n      list: {}\r\n    }\r\n  },\r\n  mounted() {\r\n    $nuxt.$store.commit('setCartTitle', '支付订单');\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    getList(){\r\n      pay($nuxt.$route.query.id).then(response => {\r\n        if(response.state !== 1) {  // 订单发生改变时，直接跳转到结果页\r\n          if (response.state === 4) {\r\n            // $nuxt.$router.replace('/user/indent/list')\r\n            $nuxt.$router.replace({path: '/user/indent/detail', query:{id:$nuxt.$route.query.id}})\r\n          } else {\r\n            $nuxt.$router.replace('/money/success')\r\n          }\r\n\r\n        }\r\n        this.loading = false;\r\n        this.list = response\r\n      }).catch(error=>{\r\n        this.$message({\r\n          message: '请求参数有误',\r\n          type: 'error'\r\n        });\r\n\r\n      })\r\n    },\r\n    // 显示详情\r\n    showDetail(){\r\n      this.detail = !this.detail\r\n    },\r\n    // 支付\r\n    payment(type){\r\n      this.buttonLoading = true\r\n      if(type === 1){ // 余额支付\r\n        balancePay({id:$nuxt.$route.query.id}).then(response => {\r\n          this.buttonLoading = false\r\n          $nuxt.$router.replace('/money/success')\r\n        })\r\n      }else{\r\n        unifiedPayment({\r\n          id: $nuxt.$route.query.id,\r\n          platform: type,\r\n          trade_type: 'NATIVE',\r\n          type: 'goodsIndent'\r\n        }).then(response => {\r\n          this.centerDialogVisible = true\r\n          this.qrcode = response.code_url\r\n          this.buttonLoading = false\r\n          if (this.timer) {\r\n            clearInterval(this.timer)\r\n            this.timer = setInterval(() => {\r\n              this.getList()\r\n            }, 5000);\r\n          } else {\r\n            this.timer = setInterval(() => {\r\n              this.getList()\r\n            }, 5000);\r\n          }\r\n        }).catch(error=>{\r\n          this.$message({\r\n            message: '支付配置有误，请检查',\r\n            type: 'error'\r\n          });\r\n        })\r\n      }\r\n    }\r\n  },\r\n  destroyed(){\r\n    clearInterval(this.timer)\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"img/weixin-pay.ee5865e.jpg\";","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./pay.vue?vue&type=style&index=0&id=40e52894&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".vue-qrcode[data-v-40e52894]{text-align:center}.main-color[data-v-40e52894]{margin-left:5px;margin-right:5px;color:#fa524c}.money-pay[data-v-40e52894]{margin:40px 0}.mode-payment-box[data-v-40e52894]{margin-top:30px}.mode-payment-box .title[data-v-40e52894]{font-size:18px;margin-top:10px}.mode-payment-box .min-title[data-v-40e52894]{font-size:16px;color:#616161;margin-bottom:20px}.mode-payment-box .list[data-v-40e52894]{display:flex;margin-bottom:20px}.mode-payment-box .list .li[data-v-40e52894]{border:1px solid #e0e0e0;text-align:center;cursor:pointer;overflow:hidden;min-width:174px;height:60px;line-height:60px;margin-left:14px;padding-left:10px;padding-right:10px}.mode-payment-box .list .li.on[data-v-40e52894],.mode-payment-box .list .li[data-v-40e52894]:hover{border-color:#fa524c}.pay-order[data-v-40e52894]{margin-top:20px;margin-bottom:20px;display:flex}.pay-order .el-icon-circle-check[data-v-40e52894]{font-size:80px;color:#83c44e;margin-left:30px;margin-right:30px}.pay-order .order-info[data-v-40e52894]{position:relative;flex:1;color:#616161;margin-bottom:5px;margin-right:20px;line-height:2;font-size:14px}.pay-order .order-info .title[data-v-40e52894]{margin-bottom:10px;font-size:24px;font-weight:400;line-height:36px}.pay-order .order-info .warn span[data-v-40e52894]{color:#fa524c;margin:0 5px}.pay-order .order-info .fright[data-v-40e52894]{position:absolute;top:10px;right:0}.pay-order .order-info .fright .show-detail[data-v-40e52894]{cursor:pointer;text-align:right;margin-right:5px}.pay-order .order-info .fright .show-detail[data-v-40e52894]:hover{color:#fa524c}.pay-order .order-info .fright .total[data-v-40e52894]{display:flex;line-height:30px}.pay-order .order-info .fright .total .price[data-v-40e52894]{position:relative;top:-5px;color:#fa524c}.pay-order .order-info .fright .total .price span[data-v-40e52894]{font-size:24px}.pay-order .order-info .fright .iconfont[data-v-40e52894]{position:relative;left:5px;font-size:12px}.pay-order .order-info .order-details li[data-v-40e52894]{display:flex}.pay-order .order-info .order-details li .label[data-v-40e52894]{width:80px}.pay-order .order-info .order-details li .content .on[data-v-40e52894]{color:#fa524c}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"box\"},[_vm._ssrNode(\"<div class=\\\"money-pay\\\" data-v-40e52894>\",\"</div>\",[_c('el-card',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"container\",attrs:{\"shadow\":\"always\"}},[_c('div',{staticClass:\"pay-order\"},[_c('div',{staticClass:\"el-icon-circle-check\"}),_vm._v(\" \"),_c('div',{staticClass:\"order-info\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"订单提交成功！去付款咯～\")]),_vm._v(\" \"),_c('div',{staticClass:\"warn\"},[_vm._v(\"请在\"),_c('span',[_c('no-ssr',[(_vm.list.overtime_time)?_c('vue-countdown',{attrs:{\"time\":_vm.list.overtime_time * 1000},on:{\"end\":_vm.getList},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar days = ref.days;\nvar hours = ref.hours;\nvar minutes = ref.minutes;\nvar seconds = ref.seconds;\nreturn [_vm._v(\"\\n                \"+_vm._s(days)+\" 天 \"+_vm._s(hours)+\" 小时 \"+_vm._s(minutes)+\" 分 \"+_vm._s(seconds)+\" 秒\\n              \")]}}],null,false,1850809108)}):_vm._e()],1)],1),_vm._v(\"内完成支付, 超时后将取消订单\")]),_vm._v(\" \"),(_vm.list.good_location)?_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.detail),expression:\"!detail\"}],staticClass:\"address\"},[_vm._v(\"收货信息：\"+_vm._s(_vm.list.good_location.name)+\" \"+_vm._s(_vm.list.good_location.cellphone)+\" \"+_vm._s(_vm.list.good_location.location)),(_vm.list.good_location.address)?[_vm._v(\"(\"+_vm._s(_vm.list.good_location.address)+\")\")]:_vm._e()],2):_vm._e(),_vm._v(\" \"),(_vm.list.good_location)?_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.detail),expression:\"detail\"}],staticClass:\"order-details\"},[_c('el-divider'),_vm._v(\" \"),_c('ul',[_c('li',[_c('div',{staticClass:\"label\"},[_vm._v(\"订单号：\")]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('span',{staticClass:\"on\"},[_vm._v(_vm._s(_vm.list.identification))])])]),_vm._v(\" \"),_c('li',[_c('div',{staticClass:\"label\"},[_vm._v(\"收货信息：\")]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_vm._v(_vm._s(_vm.list.good_location.name)+\" \"+_vm._s(_vm.list.good_location.cellphone)+\" \"+_vm._s(_vm.list.good_location.location)),(_vm.list.good_location.address)?[_vm._v(\"(\"+_vm._s(_vm.list.good_location.address)+\")\")]:_vm._e()],2)]),_vm._v(\" \"),_c('li',[_c('div',{staticClass:\"label\"},[_vm._v(\"商品名称：\")]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},_vm._l((_vm.list.goods_list),function(item,index){return _c('span',{key:index},[_vm._v(_vm._s(item.good.name)+\" \")])}),0)])])],1):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"fright\"},[_c('div',{staticClass:\"total\"},[_vm._v(\"应付总额：\"),_c('div',{staticClass:\"price\"},[_c('span',[_vm._v(_vm._s(_vm._f(\"thousands\")((_vm.list.total ? _vm.list.total : 0))))]),_vm._v(\"元\")])]),_vm._v(\" \"),(_vm.list.good_location)?_c('div',{staticClass:\"show-detail\",on:{\"click\":_vm.showDetail}},[_vm._v(\"订单详情\"),_c('i',{staticClass:\"iconfont dsshop-xia\"})]):_vm._e()])])])]),_vm._ssrNode(\" \"),_c('el-card',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"container mode-payment-box\",attrs:{\"shadow\":\"always\"}},[_c('div',{staticClass:\"title\"},[_vm._v(\"选择以下支付方式付款\")]),_vm._v(\" \"),_c('el-divider'),_vm._v(\" \"),_c('div',{staticClass:\"min-title\"},[_vm._v(\"支付方式\")]),_vm._v(\" \"),_c('div',{staticClass:\"list\"},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.buttonLoading),expression:\"buttonLoading\"}],staticClass:\"li\",on:{\"click\":function($event){return _vm.payment('weixin')}}},[_c('el-image',{staticClass:\"image\",attrs:{\"src\":require('assets/img/weixin-pay.jpg'),\"fit\":\"cover\"}})],1),_vm._v(\" \"),(_vm.list.user)?_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.buttonLoading),expression:\"buttonLoading\"}],staticClass:\"li\",on:{\"click\":function($event){return _vm.payment(1)}}},[_vm._v(\"\\n          预存款支付（\"+_vm._s(_vm._f(\"thousands\")(_vm.list.user.money))+\"）\\n        \")]):_vm._e()])],1)],2),_vm._ssrNode(\" \"),_c('el-dialog',{attrs:{\"title\":\"微信支付\",\"visible\":_vm.centerDialogVisible,\"close-on-click-modal\":false,\"width\":\"400px\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.centerDialogVisible=$event}}},[_c('div',{staticClass:\"vue-qrcode\"},[_c('vue-qrcode',{attrs:{\"value\":_vm.qrcode,\"options\":{ width: 250 }}})],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('div',[_vm._v(\"请使用\"),_c('span',{staticClass:\"main-color\"},[_vm._v(\"微信\")]),_vm._v(\"扫一扫\")]),_vm._v(\" \"),_c('div',[_vm._v(\"二维码完成支付\")])])])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport js from './js/pay'\nexport default js\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./pay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./pay.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./pay.vue?vue&type=template&id=40e52894&scoped=true&\"\nimport script from \"./pay.vue?vue&type=script&lang=js&\"\nexport * from \"./pay.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./pay.vue?vue&type=style&index=0&id=40e52894&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"40e52894\",\n  \"5356006a\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AASA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AA9DA;AACA;AA8DA;AACA;AACA;AACA;AA1FA;;;;;;;ACJA;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AChFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}