{"version":3,"file":"pages/pass/login.js","sources":["webpack:///./pages/pass/login.vue?4e80","webpack:///./api/sweepLogin.js","webpack:///./pages/pass/js/login.js","webpack:///./pages/pass/login.vue?e4bd","webpack:///./pages/pass/login.vue?2fc1","webpack:///./pages/pass/login.vue?5479","webpack:///./pages/pass/login.vue","webpack:///./pages/pass/login.vue?5195","webpack:///./pages/pass/login.vue?1e57"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=21179ad1&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"2d58b930\", content, true, context)\n};","import request from '@/plugins/request'\r\nimport Qs from 'qs'\r\nexport function code() {\r\n  return request({\r\n    url: 'sweepLogin',\r\n    method: 'GET'\r\n  })\r\n}\r\nexport function verify(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'sweepLogin/verify',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\nexport function index(data) {\r\n  data = Qs.parse(data)\r\n  return request({\r\n    url: 'sweepLogin',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\n","import {login} from '@/api/login'\nimport {code, verify, index} from '@/api/sweepLogin'\nimport {verifyPlugin} from '@/api/plugin'\nimport {\n  mapMutations\n} from 'vuex';\nexport default {\n  layout: 'login',\n  head () {\n    return {\n      title: '登录' + '-' + process.env.APP_NAME\n    }\n  },\n  async asyncData (ctx) {\n    try {\n      let isSweepLogin = false\n      await verifyPlugin('sweepLogin').then(response => {\n        isSweepLogin = response.sweepLogin\n      })\n      return {\n        isSweepLogin: isSweepLogin\n      }\n    } catch(err) {\n      ctx.$errorHandler(err)\n    }\n  },\n  data() {\n    const validateCellphone = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入手机号'));\n      } else {\n        const myreg = /^1[3456789]\\d{9}$/;\n        if (!myreg.test(value)) {\n          callback(new Error('手机号格式有误'));\n        }\n        callback();\n      }\n    };\n    return {\n      isSweepLogin: false,\n      method: 1,\n      codeLoading: false,\n      codeImg: '',\n      codeTimer: null,\n      codeState: 0,\n      codeTime: 0,\n      codeUuid: 0,\n      ruleForm: {\n        cellphone: '',\n        password: '',\n        remember: false\n      },\n      loading: false,\n      rules: {\n        cellphone: [\n          { validator: validateCellphone, trigger: 'blur' }\n        ],\n        password: [\n          { required: true, message: '请输入密码', trigger: 'blur' },\n          { min: 5, message: '密码长度必须大于5位', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  beforeDestroy() {\n    clearInterval(this.codeTimer)\n  },\n  methods: {\n    ...mapMutations(['login']),\n    setMethod(index){\n      this.method = index\n      if(index === 2){\n        this.getCode()\n      }\n    },\n    // 获取二维码\n    getCode(){\n      this.codeLoading = true\n      this.codeState = 0\n      if(this.codeTimer){\n        clearInterval(this.codeTimer);\n      }\n      code().then(response => {\n        this.codeImg = response.code\n        this.codeTime = response.expires_in\n        this.codeUuid = response.uuid\n        this.codeTimer = setInterval(this.getRefreshCode, 2000);\n      }).finally(() => {\n        this.codeLoading = false\n      })\n    },\n    // 刷新登录状态\n    getRefreshCode(){\n      this.codeTime = this.codeTime-1\n      if (this.codeTime === 0) {\n        clearInterval(this.codeTimer);\n        this.codeState = 4\n      } else {\n        verify({uuid: this.codeUuid}).then(response => {\n          this.codeState = response.state\n          if(this.codeState !== 0 && this.codeState !== 1){\n            clearInterval(this.codeTimer);\n          }\n          if(this.codeState === 2){\n            index({\n              uuid: this.codeUuid\n            }).then(response => {\n              this.login(response);\n              this.$message({\n                message: '登录成功',\n                type: 'success'\n              });\n              this.loading = false;\n              const route = this.store.get('route');\n              if(route){\n                this.store.remove('route');\n                this.$router.replace({ path: route.path, query: route.query })\n              }else{\n                $nuxt.$router.replace('/user/portal')\n              }\n            }).catch(() => {\n              this.loading = false\n            })\n          }\n        })\n      }\n\n    },\n    toLogin(){\n      this.$refs['ruleForm'].validate((valid) => {\n        if (valid) {\n          this.loading = true;\n          login(this.ruleForm).then(response => {\n            response.remember = this.ruleForm.remember\n            this.login(response);\n            this.$message({\n              message: '登录成功',\n              type: 'success'\n            });\n            this.loading = false;\n            const route = this.store.get('route');\n            if(route){\n              this.store.remove('route');\n              this.$router.replace({ path: route.path, query: route.query })\n            }else{\n              $nuxt.$router.replace('/user/portal')\n            }\n          }).catch(() => {\n            this.loading = false\n          })\n        }\n      })\n    }\n  }\n}\n","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=21179ad1&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".banner-panel[data-v-21179ad1]{width:100%;height:588px;background-repeat:no-repeat;background-position:top;position:relative}.banner-panel .qr-code[data-v-21179ad1]{text-align:center;margin-top:30px}.banner-panel .qr-code .qr[data-v-21179ad1]{position:relative;margin:0 auto;border:1px solid #f4f4f4;padding:8px;width:155px;height:155px}.banner-panel .qr-code .qr .lose-efficacy[data-v-21179ad1]{position:absolute;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.7)}.banner-panel .qr-code .qr .lose-efficacy .name[data-v-21179ad1]{margin-top:50px;color:#fff;font-size:16px}.banner-panel .qr-code .qr .lose-efficacy .flush[data-v-21179ad1]{margin-top:10px}.banner-panel .qr-code .explain[data-v-21179ad1]{font-size:12px;margin:20px 0}.banner-panel .qr-code .explain span[data-v-21179ad1]{color:#fa524c;margin:0 5px}.banner-panel .qr-code .advantage[data-v-21179ad1]{display:flex;color:#999;justify-content:center}.banner-panel .qr-code .advantage div[data-v-21179ad1]{margin:0 10px}.banner-panel .qr-code .advantage div i[data-v-21179ad1]{padding-right:3px;color:#e2e1e5}.banner-panel .link[data-v-21179ad1]{position:absolute;left:0;top:0;display:block;height:588px;width:800px}.banner-panel .form[data-v-21179ad1]{margin:40px 0;height:508px}.banner-panel .form .login-method[data-v-21179ad1]{text-align:center;font-size:26px;padding:30px 0}.banner-panel .form .login-method span[data-v-21179ad1]{cursor:pointer}.banner-panel .form .login-method .on[data-v-21179ad1],.banner-panel .form .login-method span[data-v-21179ad1]:hover{color:#fa524c}.banner-panel .form .button[data-v-21179ad1]{width:100%}.banner-panel .form .other[data-v-21179ad1]{margin-top:50px;text-align:center}.banner-panel .form .other a[data-v-21179ad1]{color:#999}.banner-panel .form .other a[data-v-21179ad1]:hover{color:#fa524c}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_vm._ssrNode(\"<div class=\\\"banner-panel\\\" style=\\\"background-image: url('//cdn.cnbj1.fds.api.mi-img.com/mi-mall/72644d9b8031286de3cc74e151aefd90.jpg');\\\" data-v-21179ad1>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"container\\\" data-v-21179ad1>\",\"</div>\",[_c('el-row',{attrs:{\"gutter\":24}},[_c('el-col',{attrs:{\"span\":8,\"offset\":16}},[_c('NuxtLink',{staticClass:\"link\",attrs:{\"to\":\"/pass/login\"}}),_vm._v(\" \"),_c('el-card',{staticClass:\"form\",attrs:{\"shadow\":\"hover\"}},[_c('div',{staticClass:\"login-method\"},[_c('span',{class:{on:_vm.method === 1},on:{\"click\":function($event){return _vm.setMethod(1)}}},[_vm._v(\"账号登录\")]),_vm._v(\" \"),(_vm.isSweepLogin)?[_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_vm._v(\" \"),_c('span',{class:{on:_vm.method === 2},on:{\"click\":function($event){return _vm.setMethod(2)}}},[_vm._v(\"扫码登录\")])]:_vm._e()],2),_vm._v(\" \"),(_vm.method === 1)?_c('div',[_c('el-form',{ref:\"ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"prop\":\"cellphone\"}},[_c('el-input',{attrs:{\"maxlength\":\"11\",\"placeholder\":\"请输入手机号码\",\"clearable\":\"\"},model:{value:(_vm.ruleForm.cellphone),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"cellphone\", $$v)},expression:\"ruleForm.cellphone\"}},[_c('i',{staticClass:\"iconfont dsshop-ziyuan\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"prop\":\"password\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入密码\",\"show-password\":\"\",\"clearable\":\"\"},model:{value:(_vm.ruleForm.password),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"password\", $$v)},expression:\"ruleForm.password\"}},[_c('i',{staticClass:\"iconfont dsshop-mima\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_vm._v(\" \"),_c('el-form-item',[_c('el-checkbox',{model:{value:(_vm.ruleForm.remember),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"remember\", $$v)},expression:\"ruleForm.remember\"}},[_vm._v(\"记住密码\")])],1),_vm._v(\" \"),_c('el-button',{staticClass:\"button\",attrs:{\"type\":\"danger\",\"loading\":_vm.loading},on:{\"click\":_vm.toLogin}},[_vm._v(\"登录\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"other\"},[_c('NuxtLink',{attrs:{\"to\":\"/pass/register\"}},[_vm._v(\"立即注册\")]),_vm._v(\" \"),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_vm._v(\" \"),_c('NuxtLink',{attrs:{\"to\":\"/pass/findPassword\"}},[_vm._v(\"忘记密码？\")])],1)],1):_c('div',[_c('div',{staticClass:\"qr-code\"},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.codeLoading),expression:\"codeLoading\"}],staticClass:\"qr\"},[_c('el-image',{staticClass:\"image\",attrs:{\"src\":_vm.codeImg,\"fit\":\"scale-down\"}}),_vm._v(\" \"),(_vm.codeState === 1)?_c('div',{staticClass:\"lose-efficacy\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"扫码成功\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"flush\",attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.getCode()}}},[_vm._v(\"重新扫码\")])],1):(_vm.codeState === 3)?_c('div',{staticClass:\"lose-efficacy\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"扫码失败\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"flush\",attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.getCode()}}},[_vm._v(\"重新扫码\")])],1):(_vm.codeState === 4)?_c('div',{staticClass:\"lose-efficacy\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"二维码已失效\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"flush\",attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.getCode()}}},[_vm._v(\"刷新\")])],1):_vm._e()],1),_vm._v(\" \"),(_vm.codeState === 1)?_c('div',{staticClass:\"explain\"},[_vm._v(\"请在手机完成授权登录\")]):(_vm.codeState === 3)?_c('div',{staticClass:\"explain\"},[_vm._v(\"您拒绝授权，尝试重新扫码\")]):_c('div',{staticClass:\"explain\"},[_vm._v(\"使用\"),_c('span',[_vm._v(\"微信\")]),_vm._v(\"扫描二维码\")]),_vm._v(\" \"),_c('div',{staticClass:\"advantage\"},[_c('div',[_c('i',{staticClass:\"iconfont dsshop-kuai\"}),_vm._v(\"更快\")]),_vm._v(\" \"),_c('div',[_c('i',{staticClass:\"iconfont dsshop-anquanzhuye\"}),_vm._v(\"更安全\")]),_vm._v(\" \"),_c('div',[_c('i',{staticClass:\"iconfont dsshop-shurukuang\"}),_vm._v(\"免输入\")])])])])])],1)],1)],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport js from './js/login'\nexport default js\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=21179ad1&scoped=true&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./login.vue?vue&type=style&index=0&id=21179ad1&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"21179ad1\",\n  \"2f44f4af\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;ACvBA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AANA;AAfA;AAyBA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtFA;AA7DA;;;;;;;;ACNA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AClFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}