(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1c38"],{"0Jp/":function(e,t,i){"use strict";i.r(t);var r=i("xA3a"),a=i.n(r);for(var o in r)"default"!==o&&function(e){i.d(t,e,function(){return r[e]})}(o);t.default=a.a},"3p40":function(e,t,i){},45:function(e,t){},"6tNa":function(e,t,i){tinymce.PluginManager.add("axupimgs",function(e,t){window.axupimgs={};var i="./static/tinymce"+"/plugins/axupimgs/upfiles.html";axupimgs.images_upload_handler=e.getParam("images_upload_handler",void 0,"function"),axupimgs.images_upload_base_path=e.getParam("images_upload_base_path","","string"),axupimgs.axupimgs_filetype=e.getParam("axupimgs_filetype",".png,.gif,.jpg,.jpeg","string"),axupimgs.res=[];var r=function(){return e.windowManager.openUrl({title:"Ax多图片上传",size:"large",url:i,buttons:[{type:"cancel",text:"Close"},{type:"custom",text:"插入图片",name:"save",primary:!0}],onAction:function(t,i){switch(i.name){case"save":var r="",a=axupimgs.res,o=a.length;if(o<1)return alert("请选上传文件"),!1;for(let e=0;e<o;e++)a[e].url&&(r+='<img src="'+a[e].url+'" />');e.insertContent(r),axupimgs.res=[],t.close()}}})};return e.ui.registry.getAll().icons.axupimgs||e.ui.registry.addIcon("axupimgs",'<svg viewBox="0 0 1280 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M1126.2,779.8V87.6c0-24-22.6-86.9-83.5-86.9H83.5C14.7,0.7,0,63.7,0,87.7v692c0,36.2,29.2,89.7,83.5,89.7l959.3-1.3c51.7,0,83.5-42.5,83.5-88.3zm-1044,4V86.3h961.6V783.7H82.2v0.1z" fill="#ff0000"/><path d="M603,461.6L521.1,366.3,313,629.8,227.2,546.8,102.4,716.8H972.8v-170L768.2,235.2,603.1,461.6zM284.6,358.4a105.4,105.4,0,0,0,73.5-30c19.5-19.1,30.3-45,30.2-71.8,0-56.8-45.9-103-102.4-103-56.6,0-102.4,46.1-102.4,103C183.4,313.5,228,358.4,284.6,358.4z" fill="#ff0000"/><path d="M1197.7,153.6l-0.3,669.3s13.5,113.9-67.4,113.9H153.6c0,24.1,23.9,87.2,83.5,87.2h959.3c58.3,0,83.6-49.5,83.6-89.9V240.8c-0.1-41.8-44.9-87.2-82.3-87.2z" fill="#ff0000"/></svg>'),e.ui.registry.addButton("axupimgs",{icon:"axupimgs",tooltip:"Ax多图片上传",onAction:function(){r()}}),e.ui.registry.addMenuItem("axupimgs",{icon:"axupimgs",text:"图片批量上传...",onAction:function(){r()}}),{getMetadata:function(){return{name:"Ax多图片上传",url:"axupimgs.php"}}}})},"7d6x":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(i("MpT8"));t.default=r.default},"7dcK":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.creatIds=void 0;var r=o(i("QbLZ")),a=o(i("jo6Y"));function o(e){return e&&e.__esModule?e:{default:e}}t.getLevels=n,t.flatten=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2]||{},o=i.optionValue,l=void 0===o?"id":o,s=i.optionText,u=void 0===s?"value":s,c=[],d=0,p={},f=n(e);if(0===e.length)return c;e.forEach(function(e){var t=e.leaf;if(!t||0===t.length)return!0;d=(d||1)*t.length}),t.forEach(function(e){var t=e.skus,i=(0,a.default)(e,["skus"]);p[t.map(function(e){return e.k_id+"_"+e.v_id}).join("|")]=i});for(var m=function(t){var i=[],o=[];e.forEach(function(r,a){var n=r.leaf,s={};if(!n||0===n.length)return!0;if(n.length>1){var c=parseInt(t/f[a],10)%n.length;s=e[a].leaf[c]}else s=e[a].leaf[0];r[l]&&s[l]&&(o.push(r[l]+"_"+s[l]),i.push({k_id:r[l],k:r[u],v_id:s[l],v:s[u]}))});var n=p[o.join("|")]||{},s=(0,a.default)(n,[]);c.push((0,r.default)({},s,{skus:i}))},g=0;g<d;g++)m(g);return c},t.isEqual=function(e,t,i){var r=(i||{}).optionValue,a=void 0===r?"id":r;return t.length===e.length&&t.every(function(i,r){var o=i.leaf,n=void 0===o?[]:o,l=e[r].leaf||[];return e[r][a]===t[r][a]&&n.length===l.length&&n.map(function(e){return e[a]}).join(",")===l.map(function(e){return e[a]}).join(",")})};t.creatIds=function(e){return e.reduce(function(t,i,r){return""+t+i.k_id+"-"+i.v_id+(r===e.length-1?"":"_")},"")};function n(e){for(var t=[],i=e.length-1;i>=0;i--)e[i+1]&&e[i+1].leaf?t[i]=e[i+1].leaf.length*t[i+1]||1:t[i]=1;return t}},"9D+X":function(e,t,i){"use strict";i.r(t);var r=i("7d6x"),a=i.n(r);for(var o in r)"default"!==o&&function(e){i.d(t,e,function(){return r[e]})}(o);t.default=a.a},CyJc:function(e,t,i){"use strict";var r=i("XVEj");i.n(r).a},D5mp:function(e,t,i){"use strict";i.r(t);var r=i("uzxV"),a=i("0Jp/");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("xfTD");var n=i("KHd+"),l=Object(n.a)(a.default,r.a,r.b,!1,null,null,null);l.options.__file="Detail.vue",t.default=l.exports},IAgb:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=v(i("m1cH")),o=v(i("Dbz9")),n=v(i("Yz+Y")),l=v(i("iCc5")),s=v(i("V7oC")),u=v(i("FYw3")),c=v(i("mRg0")),d=v(i("Kw5r")),p=v(i("L+H0")),f=v(i("yMd6")),m=i("7Qib"),g=i("vCG0"),_=v(i("o5wi"));function v(e){return e&&e.__esModule?e:{default:e}}var h=(0,p.default)({components:{SkuTable:f.default,AvatarImage:_.default}})(r=function(e){function t(){var e,i,r,a;(0,l.default)(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];return i=r=(0,u.default)(this,(e=t.__proto__||(0,n.default)(t)).call.apply(e,[this].concat(s))),r.addValues=[],r.productSkus=[],r.specification=[],r.type=0,r.allUnified={cost_price:null,market_price:null,price:null,inventory:null},r.imgData={type:1,size:2097152,specification:[80,150,200,250,300,350]},a=i,(0,u.default)(r,a)}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_setData",value:function(e){if(e&&e.length){var t=(0,g.param2Data)(e),i=t.productSkus,r=t.specification;this.specification=r,this.productSkus=(0,o.default)(i)}}},{key:"_setSpecification",value:function(e){this.specification=e}},{key:"_setType",value:function(e){this.type=e}},{key:"_getData",value:function(){return this.$refs.SkuTable.data}},{key:"addSpec",value:function(){this.specification.push({id:(0,m.createUniqueString)()+"_id",value:"",leaf:[]})}},{key:"delSepc",value:function(e){this.specification.splice(e,1)}},{key:"addOption",value:function(e){var t=this.addValues[e]||"";if(t=t.trim()){var i=this.specification[e].leaf,r=t.split(/\s+/).filter(function(e){return!i.some(function(t){return t.value===e})}).map(function(e){return{id:(0,m.createUniqueString)()+"_id",value:e}});this.specification[e].leaf=(0,m.uniqueArr)([].concat((0,a.default)(i),(0,a.default)(r))),this.$set(this.addValues,e,"")}}},{key:"delOption",value:function(e,t){this.specification[e].leaf.splice(t,1)}},{key:"updateUnifiedInput",value:function(e,t,i,r){this.$refs.SkuTable._setInput(t,e,i,r)}},{key:"getFile",value:function(e,t,i){this.specification[t].leaf[i].file=e.response,this.$forceUpdate(),this.updateUnifiedInput(e.response,"img",t,this.specification[t].leaf[i].value)}},{key:"disabled",get:function(){return this.specification.some(function(e){return!e.value})}},{key:"specificationFilter",get:function(){return this.specification.filter(function(e){return e.value&&e.leaf.length})}}]),t}(d.default))||r;t.default=h},JW7b:function(e,t,i){},JxI4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(i("5WJX"));i("RsPH");var a=o(i("ynI1"));function o(e){return e&&e.__esModule?e:{default:e}}i("DWi2"),i("Tqh3"),i("Oupb"),i("B9FH"),i("hOyB"),i("lDS1"),i("ZNhe"),i("MVQK"),i("Qjfq"),i("Cp0W"),i("6tNa"),t.default={name:"Tinymce",components:{Editor:a.default},props:{url:{default:"",type:String},accept:{default:"image/jpeg, image/png, image/gif",type:String},maxSize:{default:2097152,type:Number},value:{type:String,default:""},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:"lists image media table link wordcount code fullscreen preview axupimgs"},toolbar:{type:[String,Array],default:"axupimgs media lists table link | undo redo |  formatselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent  | removeformat code fullscreen image preview"},header:{type:[String,Object],default:""}},data:function(){var e=this;return{init:{language_url:"./static/tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"./static/tinymce/skins/ui/oxide",content_css:"./static/tinymce/skins/content/default/content.css",height:300,plugins:this.plugins,toolbar:this.toolbar,branding:!1,menubar:!1,images_upload_handler:function(t,i,r){if(t.blob().size>e.maxSize&&r("文件体积过大"),e.accept.indexOf(t.blob().type)>=0){var a=new XMLHttpRequest,o=new FormData,n=e;a.withCredentials=!1,a.open("POST",n.url),a.setRequestHeader("Authorization",n.header.Authorization),a.onload=function(){if(200!==a.status)return n.$emit("on-upload-fail"),void r("上传失败: "+JSON.parse(a.response).message);i(a.responseText)},o.append("file",t.blob()),o.append("type",1),o.append("size",e.maxSize),a.send(o)}else r("图片格式错误")}},myValue:this.value}},watch:{value:function(e){this.myValue=e},myValue:function(e){this.$emit("input",e)}},mounted:function(){r.default.init({})},methods:{onClick:function(e){this.$emit("onClick",e,r.default)},clear:function(){this.myValue=""}}}},L7y4:function(e,t,i){"use strict";i.r(t);var r=i("qWU2"),a=i("RTeI");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("h3kQ");var n=i("KHd+"),l=Object(n.a)(a.default,r.a,r.b,!1,null,"ab7a17f0",null);l.options.__file="index.vue",t.default=l.exports},LGSU:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-upload",{staticClass:"avatar-uploader",style:{height:e.height+"px",width:e.width+"px"},attrs:{action:e.url,data:e.imgData,headers:e.imgHeaders,"show-file-list":!1,"on-success":e.handleSuccessList,"before-upload":e.beforeUploadList,"on-error":e.handleError}},[e.file?[1===e.imgData.type?i("el-image",{attrs:{src:e.file,fit:"cover"}}):i("i",{staticClass:"el-icon-folder avatar-uploader-icon",style:{height:e.height+"px",width:e.width+"px"}})]:i("i",{staticClass:"el-icon-plus avatar-uploader-icon",style:{height:e.height+"px",width:e.width+"px"}})],2)],1)},a=[];i.d(t,"a",function(){return r}),i.d(t,"b",function(){return a})},MOWT:function(e,t,i){},MpT8:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("X4fA");t.default={name:"AvatarImage",props:{imgData:{type:Object,default:function(){return{type:1,size:2097152,specification:[80,150]}}},format:{type:Array,default:function(){return["image/jpeg","image/gif","image/png","image/bmp"]}},height:{type:Number,default:160},width:{type:Number,default:160},file:{type:String,default:""}},data:function(){return{url:"http://dsshop.test/api/v1/admin/uploadPictures",imgHeaders:{Authorization:(0,r.getToken)("token_type")+" "+(0,r.getToken)("access_token")}}},watch:{},mounted:function(){},methods:{handleSuccessList:function(e,t){this.$emit("getFile",t)},beforeUploadList:function(e){var t=e.size<this.imgData.size;return-1===this.format.indexOf(e.type)?(this.$message.error("请上传正确的文件格式"),!1):(t||this.$message.error("上传文件大小不能超过 "+e.size/1024/1024+"MB!"),t)},handleError:function(e){this.$message.error(JSON.parse(e.message).message)}}}},RTeI:function(e,t,i){"use strict";i.r(t);var r=i("IAgb"),a=i.n(r);for(var o in r)"default"!==o&&function(e){i.d(t,e,function(){return r[e]})}(o);t.default=a.a},Wkq7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getList=function(e){return(0,r.default)({url:"good",method:"GET",params:e})},t.count=function(){return(0,r.default)({url:"goodCount",method:"GET"})},t.create=function(e){return e=a.default.parse(e),(0,r.default)({url:"good",method:"POST",data:e})},t.edit=function(e){return e=a.default.parse(e),(0,r.default)({url:"good/"+e.id,method:"POST",data:e})},t.destroy=function(e,t){return t=a.default.parse(t),(0,r.default)({url:"good/destroy/"+e,method:"POST",data:t})},t.detail=function(e){return(0,r.default)({url:"good/"+e,method:"GET"})},t.state=function(e,t){return t=a.default.parse(t),(0,r.default)({url:"good/state/"+e,method:"POST",data:t})},t.specification=function(e){return(0,r.default)({url:"good/specification/"+e,method:"GET"})};var r=o(i("t3Un")),a=o(i("Qyje"));function o(e){return e&&e.__esModule?e:{default:e}}},XVEj:function(e,t,i){},alm3:function(e,t,i){"use strict";i.r(t);var r=i("rqW4"),a=i("v1P2");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);var n=i("KHd+"),l=Object(n.a)(a.default,r.a,r.b,!1,null,null,null);l.options.__file="index.vue",t.default=l.exports},h3kQ:function(e,t,i){"use strict";var r=i("JW7b");i.n(r).a},jqbs:function(e,t,i){"use strict";i.r(t);var r=i("w4xS"),a=i.n(r);for(var o in r)"default"!==o&&function(e){i.d(t,e,function(){return r[e]})}(o);t.default=a.a},o5wi:function(e,t,i){"use strict";i.r(t);var r=i("LGSU"),a=i("9D+X");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("CyJc");var n=i("KHd+"),l=Object(n.a)(a.default,r.a,r.b,!1,null,"aeb3b832",null);l.options.__file="AvatarImage.vue",t.default=l.exports},pESi:function(e,t,i){"use strict";var r=i("MOWT");i.n(r).a},qWU2:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("h3",[e._v("设置产品参数")]),i("el-form-item",[i("div",{staticClass:"sku_container"},[e._l(e.specification,function(t,r){return i("div",{key:t.id,staticClass:"sku_group mb10"},[i("div",{staticClass:"spec_title"},[i("span",{staticClass:"label"},[e._v("规格名：")]),i("el-input",{staticClass:"input",attrs:{placeholder:"请输入规格名"},model:{value:t.value,callback:function(i){e.$set(t,"value","string"==typeof i?i.trim():i)},expression:"spec.value"}}),i("span",{staticClass:"remove",on:{click:function(t){e.delSepc(r)}}},[e._v("×")])],1),i("div",{staticClass:"group_container"},[i("span",{staticClass:"label"},[e._v("规格值：")]),e._l(t.leaf,function(t,a){return i("el-popover",{key:a,attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("div",{staticClass:"popover"},[i("el-input",{staticStyle:{width:"110px"},model:{value:t.value,callback:function(i){e.$set(t,"value","string"==typeof i?i.trim():i)},expression:"option.value"}}),i("avatar-image",{staticClass:"upload",attrs:{file:t.file,imgData:e.imgData,height:36,width:36},on:{getFile:function(t){return e.getFile(t,r,a)}}}),i("el-tooltip",{attrs:{effect:"dark",content:"统一设置该规格图片，最新上传的将替换旧的图片",placement:"top-start"}},[i("i",{staticClass:"el-icon-question"})])],1),i("div",{staticClass:"sku_item",attrs:{slot:"reference"},slot:"reference"},[i("span",{staticClass:"remove",on:{click:function(t){t.stopPropagation(),e.delOption(r,a)}}},[e._v("×")]),i("div",{staticClass:"text"},[e._v(e._s(t.value))])])])}),i("el-input",{staticClass:"input",attrs:{"suffix-icon":"el-icon-plus",placeholder:"多个产品属性以空格隔开"},on:{blur:function(t){e.addOption(r)}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.addOption(r)}},model:{value:e.addValues[r],callback:function(t){e.$set(e.addValues,r,t)},expression:"addValues[index]"}})],2)])}),i("div",{staticClass:"spec_title"},[i("el-button",{attrs:{type:"info",disabled:e.disabled},on:{click:e.addSpec}},[e._v("添加规格项目")])],1)],2)]),i("el-form-item",{staticClass:"sku-unified-set",attrs:{label:"统一设置"}},[i("el-input",{staticClass:"input",attrs:{placeholder:"成本价",clearable:"clearable"},on:{input:function(t){return e.updateUnifiedInput(t,"cost_price")}},model:{value:e.allUnified.cost_price,callback:function(t){e.$set(e.allUnified,"cost_price",t)},expression:"allUnified.cost_price"}}),i("el-input",{staticClass:"input",attrs:{placeholder:"市场价",clearable:"clearable"},on:{input:function(t){return e.updateUnifiedInput(t,"market_price")}},model:{value:e.allUnified.market_price,callback:function(t){e.$set(e.allUnified,"market_price",t)},expression:"allUnified.market_price"}}),i("el-input",{staticClass:"input",attrs:{placeholder:"销售价",clearable:"clearable"},on:{input:function(t){return e.updateUnifiedInput(t,"price")}},model:{value:e.allUnified.price,callback:function(t){e.$set(e.allUnified,"price",t)},expression:"allUnified.price"}}),i("el-input",{staticClass:"input",attrs:{placeholder:"库存",clearable:"clearable"},on:{input:function(t){return e.updateUnifiedInput(t,"inventory")}},model:{value:e.allUnified.inventory,callback:function(t){e.$set(e.allUnified,"inventory",t)},expression:"allUnified.inventory"}})],1),i("el-form-item",[i("div",{staticClass:"sku_container"},[i("SkuTable",{ref:"SkuTable",attrs:{specification:e.specificationFilter,type:e.type,productSkus:e.productSkus},on:{"update:specification":function(t){e.specificationFilter=t},"update:productSkus":function(t){e.productSkus=t}}})],1)])],1)},a=[];i.d(t,"a",function(){return r}),i.d(t,"b",function(){return a})},rqW4:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tinymce-box"},[i("editor",{attrs:{init:e.init,disabled:e.disabled},on:{onClick:e.onClick},model:{value:e.myValue,callback:function(t){e.myValue=t},expression:"myValue"}})],1)},a=[];i.d(t,"a",function(){return r}),i.d(t,"b",function(){return a})},uzxV:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"createPost-container",staticStyle:{"padding-top":"40px"}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{"padding-left":"100px","padding-right":"100px"},attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[i("h3",[e._v("基本信息")]),e._v(" "),i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"商品类型",prop:"type"}},[i("el-radio-group",{on:{change:e.setType},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[i("el-radio-button",{attrs:{label:0}},[e._v("普通商品")]),e._v(" "),i("el-radio-button",{attrs:{label:1}},[e._v("虚拟商品")]),e._v(" "),i("el-radio-button",{attrs:{label:2}},[e._v("卡密/网盘")]),e._v(" "),i("el-radio-button",{attrs:{label:3}},[e._v("下载商品")])],1)],1),e._v(" "),i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"商品名称",prop:"name"}},[i("el-input",{attrs:{maxlength:"60",clearable:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"货号",prop:"number"}},[i("el-input",{attrs:{maxlength:"50",clearable:""},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",t)},expression:"ruleForm.number"}})],1),e._v(" "),0===e.ruleForm.type?i("el-form-item",{attrs:{label:"运费模板",prop:"freight_id"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.freight_id,callback:function(t){e.$set(e.ruleForm,"freight_id",t)},expression:"ruleForm.freight_id"}},e._l(e.freight,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),i("div",{staticClass:"el-upload__tip"},[e._v("请选择商品的所属类型，进而完善此商品的规格")])],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"主图",prop:"img"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"on-progress":e.handleProgress,action:e.actionurl,headers:e.imgHeaders,data:e.imgMasterData}},[e.imgProgress?i("span",[i("el-progress",{staticClass:"progress-img",attrs:{percentage:e.imgProgressPercent,type:"circle"}})],1):i("span",[e.ruleForm.img?i("el-image",{staticClass:"avatar",attrs:{src:e.ruleForm.img,fit:"scale-down"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)]),e._v(" "),i("div",{staticClass:"el-upload__tip"},[e._v("每张不能大于2M")])],1),e._v(" "),i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"视频",prop:"video"}},[i("el-input",{attrs:{clearable:"",placeholder:"视频地址"},on:{blur:e.setVideo},model:{value:e.ruleForm.video,callback:function(t){e.$set(e.ruleForm,"video",t)},expression:"ruleForm.video"}}),e._v(" "),i("el-input",{staticStyle:{"padding-top":"10px","padding-bottom":"10px"},attrs:{clearable:"",placeholder:"封面地址"},on:{blur:e.setPoster},model:{value:e.ruleForm.poster,callback:function(t){e.$set(e.ruleForm,"poster",t)},expression:"ruleForm.poster"}}),e._v(" "),e.ruleForm.video?i("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:e.playerOptions}}):e._e(),e._v(" "),i("div",{staticClass:"el-upload__tip"},[e._v("填写视频地址")])],1),e._v(" "),i("el-form-item",{attrs:{label:"图片列表",prop:"resource"}},[i("el-upload",{attrs:{limit:5,action:e.actionurl,headers:e.imgHeaders,"on-success":e.handleAvatarSuccessList,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUploadList,data:e.imgData,"file-list":e.ruleForm.imgList,multiple:"","list-type":"picture-card"}},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e._v(" "),i("div",{staticClass:"el-upload__tip"},[e._v("最多可上传5张，每张不能大于2M")])],1),e._v(" "),i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"关键字",prop:"keywords"}},[i("el-input",{attrs:{maxlength:"255",clearable:""},model:{value:e.ruleForm.keywords,callback:function(t){e.$set(e.ruleForm,"keywords",t)},expression:"ruleForm.keywords"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"短描述",prop:"short_description"}},[i("el-input",{attrs:{maxlength:"160",clearable:""},model:{value:e.ruleForm.short_description,callback:function(t){e.$set(e.ruleForm,"short_description",t)},expression:"ruleForm.short_description"}})],1),e._v(" "),i("h3",[e._v("商品规格")]),e._v(" "),i("el-form-item",{attrs:{label:"类目",prop:"category_id"}},[i("el-cascader",{attrs:{options:e.goods_type,props:{expandTrigger:"hover"},clearable:""},on:{change:e.goodsType},model:{value:e.ruleForm.category_id,callback:function(t){e.$set(e.ruleForm,"category_id",t)},expression:"ruleForm.category_id"}}),e._v(" "),i("div",{staticClass:"el-upload__tip"},[e._v("请选择商品的所属类型，进而完善此商品的规格")])],1),e._v(" "),e.goods_brand.length>0?i("el-form-item",{attrs:{label:"品牌",prop:"brand_id"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.change(t)}},model:{value:e.ruleForm.brand_id,callback:function(t){e.$set(e.ruleForm,"brand_id",t)},expression:"ruleForm.brand_id"}},e._l(e.goods_brand,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),e._l(e.good_attribute,function(t,r){return i("el-form-item",{key:r,attrs:{label:t.name}},[1===t.type?i("el-input",{staticStyle:{width:"400px"},attrs:{clearable:""},on:{input:function(t){e.change(t)}},model:{value:e.ruleForm.good_specification[r].data,callback:function(t){e.$set(e.ruleForm.good_specification[r],"data",t)},expression:"ruleForm.good_specification[i]['data']"}}):2===t.type?i("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.change(t)}},model:{value:e.ruleForm.good_specification[r].data,callback:function(t){e.$set(e.ruleForm.good_specification[r],"data",t)},expression:"ruleForm.good_specification[i]['data']"}},e._l(t.value,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t}})})):i("el-select",{attrs:{clearable:"",multiple:"",placeholder:"请选择"},on:{change:function(t){e.change(t)}},model:{value:e.ruleForm.good_specification[r].data,callback:function(t){e.$set(e.ruleForm.good_specification[r],"data",t)},expression:"ruleForm.good_specification[i]['data']"}},e._l(t.value,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t}})}))],1)}),e._v(" "),i("sku",{ref:"SkuDemo"}),e._v(" "),i("h3",[e._v("详情")]),e._v(" "),i("el-form-item",{attrs:{label:"详情",prop:"details"}},[i("tinymce",{ref:"editor",attrs:{disabled:e.disabled,url:e.actionurl,header:e.imgHeaders},model:{value:e.ruleForm.details,callback:function(t){e.$set(e.ruleForm,"details",t)},expression:"ruleForm.details"}})],1),e._v(" "),i("h3",[e._v("设置")]),e._v(" "),i("el-form-item",{attrs:{label:"上架时间",prop:"is_show"}},[i("el-radio-group",{model:{value:e.ruleForm.is_show,callback:function(t){e.$set(e.ruleForm,"is_show",t)},expression:"ruleForm.is_show"}},[i("el-radio",{attrs:{label:0}},[e._v("暂不售卖，放入仓库")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("立即上架售卖")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("定时上架\n          "),i("el-date-picker",{attrs:{disabled:2!==e.ruleForm.is_show,type:"date",placeholder:"选择日期时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.ruleForm.timing,callback:function(t){e.$set(e.ruleForm,"timing",t)},expression:"ruleForm.timing"}})],1)],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"减库存方式",prop:"is_inventory"}},[i("el-radio-group",{model:{value:e.ruleForm.is_inventory,callback:function(t){e.$set(e.ruleForm,"is_inventory",t)},expression:"ruleForm.is_inventory"}},[i("el-radio",{attrs:{label:0}},[e._v("拍下减库存")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("付款减库存")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"是否推荐",prop:"is_recommend"}},[i("el-radio-group",{model:{value:e.ruleForm.is_recommend,callback:function(t){e.$set(e.ruleForm,"is_recommend",t)},expression:"ruleForm.is_recommend"}},[i("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"是否新品",prop:"is_new"}},[i("el-radio-group",{model:{value:e.ruleForm.is_new,callback:function(t){e.$set(e.ruleForm,"is_new",t)},expression:"ruleForm.is_new"}},[i("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"是否热销",prop:"is_hot"}},[i("el-radio-group",{model:{value:e.ruleForm.is_hot,callback:function(t){e.$set(e.ruleForm,"is_hot",t)},expression:"ruleForm.is_hot"}},[i("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"排序",prop:"sort"}},[i("el-radio-group",{model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}},[i("el-input",{staticStyle:{width:"80px"},attrs:{maxlength:"11",clearable:""},model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}})],1)],1),e._v(" "),i("el-form-item",{staticClass:"float-button"},[i("el-button",{attrs:{loading:e.formLoading,type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.create():e.edit()}}},[e._v("提交")])],1)],2)],1)},a=[];i.d(t,"a",function(){return r}),i.d(t,"b",function(){return a})},v1P2:function(e,t,i){"use strict";i.r(t);var r=i("JxI4"),a=i.n(r);for(var o in r)"default"!==o&&function(e){i.d(t,e,function(){return r[e]})}(o);t.default=a.a},vCG0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(i("/f1G")),a=s(i("YEIV")),o=s(i("QbLZ"));t.param2Data=function(e){if(!e||!e.length)return;var t={},i={},s={},u=e.map(function(e){var r=(0,o.default)({},e,{product_sku_id:e.id,skus:e.product_sku.map(function(e){var r=(0,n.createUniqueString)()+"_id",l=(0,n.createUniqueString)()+"_id";i[e.key]||(i[e.key]=r),s[e.value]||(s[e.value]=l);var u=i[e.key],c=s[e.value];return t[e.key]={value:e.key,id:u,leaf:(0,o.default)({},t[e.key]?t[e.key].leaf:{},(0,a.default)({},e.value,{value:e.value,id:c}))},{k_id:u,k:e.key,v_id:c,v:e.value}})});return(0,o.default)({},r,{ids:(0,l.creatIds)(r.skus)})}),c=(0,r.default)(t).map(function(e){return(0,o.default)({},e,{leaf:(0,r.default)(e.leaf)})});return{productSkus:u,specification:c}};var n=i("7Qib"),l=i("7dcK");function s(e){return e&&e.__esModule?e:{default:e}}},w4xS:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=v(i("Yz+Y")),o=v(i("iCc5")),n=v(i("V7oC")),l=v(i("FYw3")),s=v(i("mRg0")),u=v(i("QbLZ")),c=v(i("gDS+")),d=v(i("Kw5r")),p=v(i("L+H0")),f=i("7dcK"),m=i("7Qib"),g=i("X4fA"),_=v(i("o5wi"));function v(e){return e&&e.__esModule?e:{default:e}}var h=(0,p.default)({components:{AvatarImage:_.default},props:{specification:{type:Array,default:function(){return[]}},type:{type:Number,default:0},productSkus:{type:Array,default:function(){return[]}}},data:function(){return{actionurl:"http://dsshop.test/api/v1/admin/uploadPictures",imgHeaders:{Authorization:"Bearer "+(0,g.getToken)("access_token")},imgData:{type:1,size:2097152,specification:[80,150,200,250,300,350]},fileFormat:["application/x-zip-compressed","application/zip","application/json","image/jpeg","image/png","image/gif"],fileData:{type:2,full:!0,size:5242880},dialogFormVisible:!1,ruleForm:{is_fixed:1,code_type:0,index:0,good_code:[]}}},computed:{skusList:function(){return(0,f.flatten)(this.specification).map(function(e){return{skus:e.skus,ids:(0,f.creatIds)(e.skus)}})},columns:function(){return this.specification.map(function(e){return{label:e.value,formater:function(t){return t.skus.find(function(t){return t.k===e.value}).v}}})}},methods:{updateInput:function(e,t,i){this.data[t][i]=e,this.data=JSON.parse((0,c.default)(this.data))},_setInput:function(e,t,i,r){this.data.map(function(a){"img"===e?a.product_sku[i].value===r&&(a[e]=t):a[e]=t}),this.data=JSON.parse((0,c.default)(this.data))},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return-1===["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?(this.$message.error("请上传正确的图片格式"),!1):(t||this.$message.error("上传头像图片大小不能超过 2MB!"),t)},specificationMarketAvatarSuccess:function(e,t){this.data[t].img=e,this.data=JSON.parse((0,c.default)(this.data))},getFileFile:function(e,t){this.data[t].file=e.response.url,this.data[t].file_name=e.name,this.data=JSON.parse((0,c.default)(this.data))},addRuleForm:function(e,t){e.good_code?(this.ruleForm.is_fixed=e.is_fixed,this.ruleForm.code_type=e.code_type,this.ruleForm.index=t,this.ruleForm.good_code=e.good_code):this.ruleForm={is_fixed:1,code_type:0,index:t,good_code:[]},this.dialogFormVisible=!0},addGoodCode:function(){this.ruleForm.good_code.push({name:"",code:""})},importGoodCode:function(){var e=this,t="每行一条卡密，每行格式：卡号1:卡密1";1===this.ruleForm.code_type&&(t="每行一条网盘数据，每行格式：网盘地址1:提取码1"),this.$prompt("请输入卡密","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPlaceholder:t}).then(function(t){var i=t.value.split(/[(\r\n)\r\n]+/),r=null;for(var a in i){if((r=i[a].split(":")).length<2)return e.$message({type:"info",message:"卡密格式有误"}),!1;e.ruleForm.good_code.push({name:r[0],code:r[1]})}})},deleteGoodCode:function(e){this.ruleForm.good_code.splice(e,1)},saveGoodCode:function(){this.data[this.ruleForm.index].code_type=this.ruleForm.code_type,this.data[this.ruleForm.index].good_code=this.ruleForm.good_code,this.data[this.ruleForm.index].is_fixed=this.ruleForm.is_fixed,this.dialogFormVisible=!1,this.data=JSON.parse((0,c.default)(this.data))},changeIsFixed:function(){this.ruleForm.good_code=[]}},watch:{skusList:{deep:!0,immediate:!0,handler:function(e,t){var i=this;if(!e.length)return this.data=[];if(!t||!t.length)return this.initData(e);if(e.length===t.length)return this.data=e.map(function(e,t){return(0,u.default)({},i.data[t],e)});if(e[0].skus.length!==t[0].skus.length)return this.initData(e);var r=this.diffIds(e,t);if(e.length>t.length){var a=[];e.forEach(function(e){var t=i.data.find(function(t){return t.ids===e.ids});t?a.push(t):a.push((0,u.default)({},e,{format:"",guide_price:void 0,purchase_price:void 0,sell_price:void 0}))}),this.data=a}else this.data=this.data.filter(function(e){return!r.includes(e.ids)})}}}})(r=function(e){function t(){var e,i,r,n;(0,o.default)(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return i=r=(0,l.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(u))),r.data=[],r.coefficient={purchase_coefficient:0,guide_coefficient:0},r.columnsProps={align:"center",minWidth:100},n=i,(0,l.default)(r,n)}return(0,s.default)(t,e),(0,n.default)(t,[{key:"diffIds",value:function(e,t){return e=e.map(function(e){return e.ids}),t=t.map(function(e){return e.ids}),(0,m.diffArary)(e,t)}},{key:"initData",value:function(e){if(this.productSkus&&this.productSkus.length)return this.data=this.productSkus,void this.$emit("update:productSkus",[]);this.data=e.map(function(e){return(0,u.default)({},e,{format:"",guide_price:void 0,purchase_price:void 0,sell_price:void 0})})}}]),t}(d.default))||r;t.default=h},xA3a:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("Wkq7"),a=i("X4fA"),o=s(i("alm3")),n=s(i("L7y4"));i("/aIJ");var l=i("1tPa");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"GoodDetail",components:{tinymce:o.default,Sku:n.default,videoPlayer:l.videoPlayer},props:{isEdit:{type:Boolean,default:!1}},data:function(){var e=function(e,t,i){t&&(/^\d+.?\d{0,2}$/.test(t)||i(new Error("只允许数字，并小数点后最多只能输入两位2"))),i()};return{formLoading:!1,dialogFormVisible:!1,playerOptions:{playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"",src:""}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}},freight:[],disabled:!1,sku:[],goods_brand:[],attributeMarket:[],dialogImageUrl:"",actionurl:"http://dsshop.test/api/v1/admin/uploadPictures",imgHeaders:{Authorization:"Bearer "+(0,a.getToken)("access_token")},good_attribute:[],goods_type:[],imgMasterData:{type:1,size:2097152,specification:[80,150,200,250,300,350]},imgData:{type:1,size:2097152},dialogVisible:!1,loading:!1,id:"",ruleForm:{type:0,name:"",category_id:"",number:"",brand_id:null,inventory:"",good_specification:[],market_price:"",price:"",keywords:"",short_description:"",details:"",img:"",cost_price:"",is_show:1,is_recommend:0,is_new:0,is_hot:0,is_inventory:0,sort:5,freight_id:""},imgProgress:!1,dialogStatus:"create",imgProgressPercent:0,rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],number:[{required:!0,message:"请输入货号",trigger:"blur"}],freight_id:[{required:!0,message:"请选择运费模板",trigger:"change"}],img:[{required:!0,message:"请上传主图",trigger:"change"}],market_price:[{required:!1,validator:e,message:"只允许数字，并小数点后最多只能输入两位",trigger:"blur"}],cost_price:[{required:!1,validator:e,message:"只允许数字，并小数点后最多只能输入两位",trigger:"blur"}],price:[{required:!1,validator:e,message:"只允许数字，并小数点后最多只能输入两位",trigger:"blur"}],inventory:[{required:!1,message:"只能输入整数",trigger:"blur"}],brand_id:[{required:!0,message:"请选择品牌",trigger:"blur"}],category_id:[{required:!0,message:"请选择类目",trigger:"blur"}],details:[{required:!0,message:"请输入详情",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]}}},created:function(){this.isEdit&&(this.id=this.$route.query.id),this.getList()},methods:{getList:function(){var e=this;this.loading=!0,(0,r.detail)(this.id?this.id:0,{category:(0,a.getToken)("applyCategory")}).then(function(t){e.id>0&&(e.ruleForm=t.data.goods,"普通商品"===e.ruleForm.type?e.ruleForm.type=0:"虚拟商品"===e.ruleForm.type?e.ruleForm.type=1:"卡密/网盘"===e.ruleForm.type?e.ruleForm.type=2:"下载商品"===e.ruleForm.type&&(e.ruleForm.type=3),e.setType(e.ruleForm.type),e.goodsType(!0),e.dialogStatus="update",e.$refs.SkuDemo._setData(e.ruleForm.good_sku),e.ruleForm.video&&(e.playerOptions.sources[0].src=e.ruleForm.video),e.ruleForm.poster&&(e.playerOptions.poster=e.ruleForm.poster)),e.goods_type=t.data.category,e.freight=t.data.freight,e.loading=!1})},create:function(){var e=this;this.formLoading=!0,this.$refs.ruleForm.validate(function(t){t?(e.ruleForm.good_sku=e.getSkuData(),(0,r.create)(e.ruleForm).then(function(){e.$notify({title:e.$t("hint.succeed"),message:e.$t("hint.creatingSuccessful"),type:"success",duration:2e3}),e.formLoading=!1,setTimeout(e.$router.back(-1),2e3)}).catch(function(){e.formLoading=!1})):e.formLoading=!1})},edit:function(){var e=this;this.formLoading=!0,this.$refs.ruleForm.validate(function(t){t?(e.ruleForm.good_sku=e.getSkuData(),(0,r.edit)(e.ruleForm).then(function(){e.$notify({title:e.$t("hint.succeed"),message:e.$t("hint.updateSuccessful"),type:"success",duration:2e3}),e.formLoading=!1,setTimeout(e.$router.push({path:"/commodityManagement/good/goodList?page="+e.$route.query.page+"&activeIndex="+e.$route.query.activeIndex}),2e3)}).catch(function(){e.formLoading=!1})):e.formLoading=!1})},handleAvatarSuccess:function(e,t){this.ruleForm.img=t.response,this.imgProgress=!1,this.imgProgressPercent=0},handleProgress:function(e,t){this.imgProgressPercent=e.percent},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return-1===["image/png"].indexOf(e.type)?(this.$message.error("请上传正确的图片格式"),!1):(t||this.$message.error("上传头像图片大小不能超过 2MB!"),this.imgProgress=!0,t)},beforeAvatarUploadList:function(e){var t=e.size/1024/1024<2;return-1===["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?(this.$message.error("请上传正确的图片格式"),!1):(t||this.$message.error("上传头像图片大小不能超过 2MB!"),t)},handleAvatarSuccessList:function(e,t,i){this.ruleForm.imgList=i,this.imgProgress=!1,this.imgProgressPercent=0},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){this.ruleForm.imgList=t},addAttribute:function(e){this.attributeMarket[e.id]?this.attributeMarket[e.id].push({img:"",name:"",typename:e.name}):this.$set(this.attributeMarket,e.id,[{img:"",name:"",typename:e.name}])},goodsType:function(e){var t=this,i=null;(i=this.ruleForm.category_id.length?this.ruleForm.category_id[this.ruleForm.category_id.length-1]:0===this.ruleForm.category_id.length?null:this.ruleForm.category_id)&&(0,r.specification)(i).then(function(i){if(t.ruleForm.good_specification=[],e||(t.ruleForm.brand_id=null),t.goods_brand=[],t.good_attribute=[],!t.isEdit&&t.isDescription){var r=[];i.data.good_parameter_group.forEach(function(e){r.push({id:e.id,value:e.value,leaf:e.good_parameter})}),t.$refs.SkuDemo._setSpecification(r)}var a=t;i.data.specification_on.length>0?(t.good_attribute=i.data.specification_on,i.data.specification_on.forEach(function(t,i){if(a.ruleForm.good_specification_old&&a.ruleForm.good_specification_old.length>0&&e){var r=a.ruleForm.good_specification_old.findIndex(function(e){return e.specification_id===t.id});-1===r?a.ruleForm.good_specification.push({specification_id:t.id,data:null}):a.ruleForm.good_specification.push(a.ruleForm.good_specification_old[r])}else a.ruleForm.good_specification.push({specification_id:t.id,data:null})})):t.good_attribute=[],i.data.brand_on.length>0&&(t.ruleForm.brand_id=t.ruleForm.brand_id?t.ruleForm.brand_id:null,t.goods_brand=i.data.brand_on)})},getSkuData:function(){var e=this;return this.$refs.SkuDemo._getData().map(function(t){var i=t.id,r=t.format,a=t.img,o=t.market_price,n=t.cost_price,l=t.price,s=t.inventory,u=t.skus,c=t.code_type,d=t.is_fixed,p=t.good_code,f=t.file,m=t.file_name,g=t.file_id,_=u.reduce(function(e,t){return""+e+t.k+"："+t.v+"——"},"");if(void 0===o)throw e.$message.error(_+" 未输入市场价"),e.formLoading=!1,new Error("请输入市场价");if(void 0===n)throw e.$message.error(_+" 未输入成本价"),e.formLoading=!1,new Error("请输入成本价");if(void 0===l)throw e.$message.error(_+" 未输入销售价"),e.formLoading=!1,new Error("请输入销售价");if(void 0===s)throw e.$message.error(_+" 未输入库存"),e.formLoading=!1,new Error("请输入库存");if(2===e.ruleForm.type){if(!p)throw e.$message.error(_+" 未设置卡密"),e.formLoading=!1,new Error("请设置卡密");if(0===p.length)throw e.$message.error(_+" 未设置卡密"),e.formLoading=!1,new Error("请设置卡密");if(p.length>1&&Number(s)>p.length)throw e.$message.error(_+" 卡密数量必须大于等于库存"),e.formLoading=!1,new Error("卡密数量必须大于等于库存")}else if(3===e.ruleForm.type&&void 0===f)throw e.$message.error(_+" 请上传文件"),e.formLoading=!1,new Error("请上传文件");return{id:i,format:r,img:a,market_price:o,cost_price:n,price:l,inventory:s,code_type:c,good_code:p,is_fixed:d,file:f,file_name:m,file_id:g,product_sku:u.map(function(e){return{key:e.k,value:e.v}})}})},setVideo:function(e){this.playerOptions.sources[0].src=this.ruleForm.video},setPoster:function(e){this.playerOptions.poster=this.ruleForm.poster},change:function(e){this.$forceUpdate()},setType:function(e){this.$refs.SkuDemo._setType(e)}}}},xfTD:function(e,t,i){"use strict";var r=i("3p40");i.n(r).a},yL4Y:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("el-table",e._g(e._b({staticStyle:{width:"100%"},attrs:{data:e.data,border:""}},"el-table",e.$attrs,!1),e.$listeners),[e._l(e.columns,function(t,r){return i("el-table-column",{key:r,attrs:{label:t.label,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.skus[r].v)+"\n      ")]}}])})}),e._v(" "),i("el-table-column",{attrs:{prop:"img",label:"图片",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"cost_price"}},[i("el-upload",{staticClass:"avatar-uploaders",attrs:{"show-file-list":!1,"on-success":function(i,r){return e.specificationMarketAvatarSuccess(i,t.$index)},"before-upload":e.beforeAvatarUpload,action:e.actionurl,headers:e.imgHeaders,data:e.imgData}},[t.row.img?i("img",{staticClass:"avatar",staticStyle:{width:"80px",height:"80px"},attrs:{src:t.row.img}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icons"})])],1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"成本价(元)",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"cost_price"}},[i("el-input",{attrs:{size:"mini",placeholder:"请输入成本价",clearable:""},on:{input:function(i){return e.updateInput(i,t.$index,"cost_price")}},model:{value:t.row.cost_price,callback:function(i){e.$set(t.row,"cost_price",i)},expression:"scope.row.cost_price"}})],1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"市场价(元)",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"market_price"}},[i("el-input",{attrs:{size:"mini",placeholder:"请输入市场价",clearable:""},on:{input:function(i){return e.updateInput(i,t.$index,"market_price")}},model:{value:t.row.market_price,callback:function(i){e.$set(t.row,"market_price",i)},expression:"scope.row.market_price"}})],1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"销售价(元)",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"price"}},[i("el-input",{attrs:{size:"mini",placeholder:"请输入销售价",clearable:""},on:{input:function(i){return e.updateInput(i,t.$index,"price")}},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}})],1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"库存",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"inventory"}},[i("el-input",{attrs:{size:"mini",placeholder:"请输入库存",clearable:""},on:{input:function(i){return e.updateInput(i,t.$index,"inventory")}},model:{value:t.row.inventory,callback:function(i){e.$set(t.row,"inventory",i)},expression:"scope.row.inventory"}})],1)],1)]}}])}),e._v(" "),2===e.type?i("el-table-column",{attrs:{prop:"good_code",label:"虚拟商品",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.addRuleForm(t.row,t.$index)}}},[e._v(e._s(t.row.good_code?"修改卡密":"添加卡密"))])]}}])}):e._e(),e._v(" "),3===e.type?i("el-table-column",{attrs:{prop:"file",label:"文件",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{attrs:{model:t.row}},[i("el-form-item",{attrs:{prop:"file"}},[i("avatar-image",{attrs:{height:80,width:80,file:t.row.file,format:e.fileFormat,"img-data":e.fileData},on:{getFile:function(i){return e.getFileFile(i,t.$index)}}}),e._v(" "),t.row.file?[i("div",{staticClass:"file-name",attrs:{title:t.row.file_name}},[e._v(e._s(t.row.file_name))])]:e._e()],2)],1)]}}])}):e._e()],2),e._v(" "),i("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.dialogFormVisible,center:"",title:"添加卡密"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"dataForm",attrs:{model:e.ruleForm,"label-position":"cente","label-width":"120px"}},[i("el-form-item",{attrs:{label:"卡密类型",prop:"code_type"}},[i("el-radio-group",{model:{value:e.ruleForm.code_type,callback:function(t){e.$set(e.ruleForm,"code_type",t)},expression:"ruleForm.code_type"}},[i("el-radio-button",{attrs:{label:0}},[e._v("卡密")]),e._v(" "),i("el-radio-button",{attrs:{label:1}},[e._v("网盘")])],1)],1),e._v(" "),i("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"是否固定卡密",prop:"is_fixed"}},[i("el-radio-group",{on:{change:e.changeIsFixed},model:{value:e.ruleForm.is_fixed,callback:function(t){e.$set(e.ruleForm,"is_fixed",t)},expression:"ruleForm.is_fixed"}},[i("el-radio-button",{attrs:{label:1}},[e._v("是")]),e._v(" "),i("el-radio-button",{attrs:{label:0}},[e._v("否")])],1),e._v(" "),i("p",[e._v("如果是非固定卡密，请确保库存和卡密数量相同")])],1),e._v(" "),i("el-form-item",{attrs:{prop:"good_code"}},[i("el-table",{staticStyle:{width:"100%",height:"200px","overflow-y":"auto"},attrs:{data:e.ruleForm.good_code}},[i("el-table-column",{attrs:{label:1===e.ruleForm.code_type?"网盘地址":"卡号",prop:"name",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{disabled:!!t.row.state,placeholder:1===e.ruleForm.code_type?"请输入网盘地址":"请输入卡号(非必填)",size:"mini",clearable:""},model:{value:t.row.name,callback:function(i){e.$set(t.row,"name",i)},expression:"scope.row.name"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:1===e.ruleForm.code_type?"提取码":"卡密",prop:"code",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{disabled:!!t.row.state,placeholder:1===e.ruleForm.code_type?"请输入提取码":"请输入卡密",size:"mini",clearable:""},model:{value:t.row.code,callback:function(i){e.$set(t.row,"code",i)},expression:"scope.row.code"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.state?e._e():i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.deleteGoodCode(t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),1===e.ruleForm.is_fixed&&0===e.ruleForm.good_code.length||0===e.ruleForm.is_fixed?i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.addGoodCode()}}},[e._v("新增")]):e._e(),e._v(" "),0===e.ruleForm.is_fixed?i("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.importGoodCode()}}},[e._v("导入卡密")]):e._e()],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveGoodCode()}}},[e._v("确定")])],1)],1)],1)},a=[];i.d(t,"a",function(){return r}),i.d(t,"b",function(){return a})},yMd6:function(e,t,i){"use strict";i.r(t);var r=i("yL4Y"),a=i("jqbs");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("pESi");var n=i("KHd+"),l=Object(n.a)(a.default,r.a,r.b,!1,null,"2e05fafe",null);l.options.__file="sku-table.vue",t.default=l.exports}}]);